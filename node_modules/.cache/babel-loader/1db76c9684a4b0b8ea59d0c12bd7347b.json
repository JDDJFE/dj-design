{"remainingRequest":"/Users/wangjunxia/work-github/dj-design/node_modules/babel-loader/lib/index.js!/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/wangjunxia/work-github/dj-design/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangjunxia/work-github/dj-design/src/views/code/code.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangjunxia/work-github/dj-design/src/views/code/code.vue","mtime":1673509764392},{"path":"/Users/wangjunxia/work-github/dj-design/babel.config.js","mtime":1660011372032},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOyAvLyBpbXBvcnQgY29kZW1pcnJvciBmcm9tICcuL2NvZGVtaXJyb3InOwovLyBpbXBvcnQgdG9IVE1MIGZyb20gJ3Zkb20tdG8taHRtbCc7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2RqQ29kZScsCiAgLy8gY29tcG9uZW50czoge2NvZGVtaXJyb3J9LAogIHByb3BzOiB7CiAgICB0eXBlOiBTdHJpbmcsCiAgICBpbmZvOiBPYmplY3QsCiAgICB2YWx1ZTogU3RyaW5nLAogICAgdGl0bGU6IFN0cmluZywKICAgIGNvZGVTaG93OiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCiAgICBkYXRhOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdDogKCkgPT4gewogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfSwKICAgIG9wdGlvbnM6IE9iamVjdCwKICAgIGluZGV4OiBOdW1iZXIKICB9LAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY29kZTogdGhpcy5zZXRDb2RlKCksCiAgICAgIHNob3dDb2RlOiBmYWxzZQogICAgfTsKICB9LAoKICB3YXRjaDogewogICAgdmFsdWU6IGZ1bmN0aW9uIChvLCBuKSB7CiAgICAgIC8vIHRoaXMuY29kZSA9IHRoaXMudmFsdWUucmVwbGFjZSgvIHs0fS9nLCAnJyk7CiAgICAgIC8vIHRoaXMuY29kZSA9IHRoaXMuaHRtbEZvcm1hdCh0aGlzLnZhbHVlKTsKICAgICAgdGhpcy5zZXRDb2RlKCk7CiAgICB9CiAgfSwKCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuaW5zZXJ0KCk7CiAgfSwKCiAgbWV0aG9kczogewogICAgc2V0Q29kZSgpIHsKICAgICAgbGV0IHNjb3BlMSA9ICc8c2NyaXB0Pic7IC8vIDwvIHNjcmlwdD7ov5nmoLflhpnmmK/kuLrop6PlhrNlc2xpbnQg5oql6ZSZCgogICAgICBsZXQgc2NvcGUyID0gJzwvIHNjcmlwdD4nLnJlcGxhY2UoJyAnLCAnJyk7CgogICAgICBpZiAodGhpcy5kYXRhLmRhdGEgfHwgdGhpcy5kYXRhLm1ldGhvZHMpIHsKICAgICAgICB0aGlzLmNvZGUgPSBgJHt0aGlzLnZhbHVlfQogICAgICAgICAgJHtzY29wZTF9CiAgICAgICAgICBleHBvcnQgZGVmYXVsdCAke3RoaXMub2JqVG9TdHJpbmcodGhpcy5kYXRhKX0KICAgICAgICAgICR7c2NvcGUyfWA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jb2RlID0gYCR7dGhpcy52YWx1ZX0KICAgICAgICAgICR7c2NvcGUxfQogICAgICAgICAgZXhwb3J0IGRlZmF1bHQgewogICAgICAgICAgICBkYXRhKCkgewogICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbWV0aG9kczogewogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICAke3Njb3BlMn1gOwogICAgICB9CgogICAgICB0aGlzLmNvZGUgPSB0aGlzLmh0bWxGb3JtYXQodGhpcy5jb2RlKTsKICAgICAgcmV0dXJuIHRoaXMuY29kZTsKICAgIH0sCgogICAgaW5zZXJ0KCkgewogICAgICBpZiAoIXRoaXMuY29kZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgbGV0IHRlbXAgPSB0aGlzLmNvZGUuc3BsaXQoJzxzY3JpcHQ+Jyk7CiAgICAgIGxldCBjb2RlID0gdGVtcFswXS5yZXBsYWNlKC9cbi9nLCAnJykucmVwbGFjZSgvPiggezEsfSk8L2csICc+PCcpOwogICAgICBsZXQgZGF0YSA9IHt9OwogICAgICBsZXQgc2NyaXB0ID0gdGVtcFsxXTsKCiAgICAgIGlmIChzY3JpcHQgJiYgc2NyaXB0LmluZGV4T2YoJ2V4cG9ydCBkZWZhdWx0ICcpID4gLTEpIHsKICAgICAgICBzY3JpcHQgPSBzY3JpcHQuc3Vic3RyaW5nKHNjcmlwdC5pbmRleE9mKCd7JyksIHNjcmlwdC5sZW5ndGgpOwogICAgICAgIHNjcmlwdCA9IHNjcmlwdC5yZXBsYWNlKCdleHBvcnQgZGVmYXVsdCAnLCAnJykucmVwbGFjZSgnPC8gc2NyaXB0PicucmVwbGFjZSgnICcsICcnKSwgJycpOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbmV3LWZ1bmMKCiAgICAgICAgZGF0YSA9IG5ldyBGdW5jdGlvbihgcmV0dXJuICR7c2NyaXB0fWApKCk7CiAgICAgIH0KCiAgICAgIFZ1ZS5jb21wb25lbnQoYGJsb2NrLWNvZGUke3RoaXMuaW5kZXh9YCwgewogICAgICAgIHRlbXBsYXRlOiBgPGRpdiBpZD0iYmxvY2stY29kZSR7dGhpcy5pbmRleH0iIGNsYXNzPSJjYXNlLWNvZGUiPmAgKyBjb2RlICsgJzwvZGl2PicsCiAgICAgICAgLi4uZGF0YQogICAgICB9KTsKICAgICAgY29uc3QgQmxvY2tDb2RlID0gVnVlLmNvbXBvbmVudChgYmxvY2stY29kZSR7dGhpcy5pbmRleH1gKTsgLy8g5Y+q6IO95p+l5om+5Yiw5YWo5bGA5rOo5YaM5Yiw57uE5Lu2CgogICAgICBjb25zdCBpbnN0YW5jZSA9IG5ldyBCbG9ja0NvZGUoKTsKICAgICAgaW5zdGFuY2UuJG1vdW50KGAjYmxvY2stY29kZSR7dGhpcy5pbmRleH1gKTsKICAgIH0sCgogICAgb2JqVG9TdHJpbmcoZGF0YSkgewogICAgICByZXR1cm4gYHsKICAgICAgICBgICsgT2JqZWN0LmtleXMoZGF0YSkubWFwKGtleSA9PiB7CiAgICAgICAgaWYgKHR5cGVvZiBkYXRhW2tleV0gPT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgcmV0dXJuIGRhdGFba2V5XS50b1N0cmluZygpLnJlcGxhY2UoJ2Z1bmN0aW9uICcsICcnKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBrZXkgKyAnOiAnICsgdGhpcy5vYmpUb1N0cmluZyhkYXRhW2tleV0pOwogICAgICB9KS5qb2luKCcsXG4nKSArIGAKICAgICAgfWA7CiAgICB9LAoKICAgIGh0bWxGb3JtYXQoaHRtbCkgewogICAgICAvLyDmoLzlvI/ljJZodG1s5Luj56CBCiAgICAgIC8vIGh0bWwucmVwbGFjZSgvfS9nLCAnfVxuJyk7CiAgICAgIGlmICghaHRtbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgbGV0IGxpc3QgPSBodG1sLnNwbGl0KCdcbicpOwogICAgICBsZXQgY291bnQgPSAwOwogICAgICBsaXN0ID0gbGlzdC5tYXAocm93ID0+IHsKICAgICAgICBpZiAoIXJvdykgewogICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0KCiAgICAgICAgbGV0IHN0ciA9IHRoaXMudHJpbShyb3cpOwogICAgICAgIHN0ciA9IHRoaXMudGFiU2l6ZShzdHIsIGNvdW50KTsKCiAgICAgICAgaWYgKHN0ci5pbmRleE9mKCc8JykgPiAtMSAmJiBzdHIuaW5kZXhPZignPCcpICE9IHN0ci5pbmRleE9mKCc8LycpIHx8IHN0ci5pbmRleE9mKCd7JykgPiAtMSkgewogICAgICAgICAgY291bnQrKzsKICAgICAgICB9CgogICAgICAgIGlmIChzdHIuaW5kZXhPZignPC8nKSA+IC0xIHx8IHN0ci5pbmRleE9mKCcvPicpID4gLTEgfHwgc3RyLmluZGV4T2YoJ30nKSA+IC0xKSB7CiAgICAgICAgICBjb3VudC0tOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgfSk7CiAgICAgIHJldHVybiBsaXN0LmpvaW4oJ1xuJyk7CiAgICB9LAoKICAgIHRyaW0oc3RyKSB7CiAgICAgIC8vIOWOu+WktOWwvuepuuagvAogICAgICByZXR1cm4gdGhpcy50cmltTGVmdCh0aGlzLnRyaW1SaWdodChzdHIpKTsKICAgIH0sCgogICAgdHJpbUxlZnQoc3RyKSB7CiAgICAgIC8vIOWOu+WktOmDqOepuuagvAogICAgICBpZiAoIXN0cikgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQoKICAgICAgaWYgKHN0ci5pbmRleE9mKCcgJykgPT0gMCkgewogICAgICAgIHJldHVybiB0aGlzLnRyaW1MZWZ0KHN0ci5zdWJzdHJpbmcoMSwgc3RyLmxlbmd0aCkpOwogICAgICB9CgogICAgICByZXR1cm4gc3RyOwogICAgfSwKCiAgICB0cmltUmlnaHQoc3RyKSB7CiAgICAgIC8vIOWOu+acq+WwvuepuuagvAogICAgICBpZiAoIXN0cikgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQoKICAgICAgaWYgKHN0ci5sYXN0SW5kZXhPZignICcpID09IHN0ci5sZW5ndGggLSAxKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudHJpbVJpZ2h0KHN0ci5zdWJzdHJpbmcoMCwgc3RyLmxlbmd0aCAtIDEpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHN0cjsKICAgIH0sCgogICAgdGFiU2l6ZShzdHIsIHNpemUpIHsKICAgICAgLy8g5aKe5Yqg6YCA5qC856ymCiAgICAgIGxldCBjb3VudCA9IHNpemU7CgogICAgICBpZiAoc3RyLmluZGV4T2YoJzwvJykgPT0gMCB8fCBzdHIuaW5kZXhPZignLz4nKSA9PSAwIHx8IHN0ci5pbmRleE9mKCd9JykgPT0gMCkgewogICAgICAgIGNvdW50LS07CiAgICAgIH0KCiAgICAgIGlmIChjb3VudCA8PSAwKSB7CiAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgfQoKICAgICAgbGV0IHRhYlN0ciA9ICcnOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgdGFiU3RyICs9ICcgICc7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YWJTdHIgKyBzdHI7CiAgICB9CgogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;AAuBA,sB,CACA;AACA;;AAEA;EACAA,cADA;EAEA;EACAC;IACAC,YADA;IAEAC,YAFA;IAGAC,aAHA;IAIAC,aAJA;IAKAC;MACAJ,aADA;MAEAK;IAFA,CALA;IASAC;MACAN,YADA;MAEAK;QACA;MACA;IAJA,CATA;IAeAE,eAfA;IAgBAC;EAhBA,CAHA;;EAqBAF;IACA;MACAG,oBADA;MAEAC;IAFA;EAIA,CA1BA;;EA2BAC;IACAT;MACA;MACA;MACA;IACA;EALA,CA3BA;;EAkCAU;IACA;EACA,CApCA;;EAqCAC;IACAC;MACA,wBADA,CAEA;;MACA;;MACA;QACA;AACA;AACA;AACA,oBAHA;MAIA,CALA,MAKA;QACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAVA;MAWA;;MACA;MACA;IACA,CAzBA;;IA0BAC;MACA;QACA;MACA;;MACA;MACA;MACA;MACA;;MACA;QACAC;QACAA,0FAFA,CAGA;;QACAV;MACA;;MACAW;QACAC,kFADA;QAEA;MAFA;MAIA,2DAlBA,CAkBA;;MACA;MACAC;IACA,CA/CA;;IAgDAC;MACA;AACA,SADA,GACAC;QACA;UACA;QACA;;QACA;MACA,CALA,EAKAC,IALA,CAKA,KALA,CADA,GAMA;AACA,QAPA;IAQA,CAzDA;;IA0DAC;MAAA;MACA;MACA;QACA;MACA;;MACA;MACA;MACAC;QACA;UACA;QACA;;QACA;QACAC;;QACA;UACAC;QACA;;QACA;UACAA;QACA;;QACA;MACA,CAbA;MAcA;IACA,CAhFA;;IAiFAC;MAAA;MACA;IACA,CAnFA;;IAoFAC;MAAA;MACA;QACA;MACA;;MACA;QACA;MACA;;MACA;IACA,CA5FA;;IA6FAC;MAAA;MACA;QACA;MACA;;MACA;QACA;MACA;;MACA;IACA,CArGA;;IAsGAC;MAAA;MACA;;MACA;QACAJ;MACA;;MACA;QACA;MACA;;MACA;;MACA;QACAK;MACA;;MACA;IACA;;EAnHA;AArCA","names":["name","props","type","info","value","title","codeShow","default","data","options","index","code","showCode","watch","mounted","methods","setCode","insert","script","Vue","template","instance","objToString","Object","join","htmlFormat","list","str","count","trim","trimLeft","trimRight","tabSize","tabStr"],"sourceRoot":"src/views/code","sources":["code.vue"],"sourcesContent":["<template>\n  <div class=\"dj-code\">\n    <h2 v-if=\"type == 'example'\">{{title}}</h2>\n    <div class=\"temp-test\" v-if=\"type == 'test' && info\">\n      <p><span>bug描述：</span>{{info.scene}}</p>\n      <p><span>更改时间：</span>{{info.repairtime}}</p>\n    </div>\n    <div :id=\"`block-code${index}`\" class=\"case-code\"></div>\n    <div class=\"temp-code\" v-if=\"codeShow\">\n      <dj-button v-show=\"!showCode\" icon=\"turning-bottom\" type=\"text\" style=\"width: 100%; padding: 10px;\" @click=\"showCode = true\"></dj-button>\n      <transition name=\"fade\">\n<!--        <codemirror v-if=\"showCode\" v-model=\"code\" :options=\"options\"></codemirror>-->\n        <dj-json v-if=\"showCode\" v-model=\"code\" theme=\"base16-dark\" language=\"vue\"/>\n      </transition>\n      <div v-show=\"showCode\" class=\"up\">\n        <dj-button icon=\"turning-top\" type=\"text\" style=\"width: 100%; padding: 10px;\" @click=\"showCode = false\"></dj-button>\n        <dj-button type=\"text\" icon=\"turning-right\" style=\"position: absolute; right: 0; padding: 10px;\" @click=\"insert()\">运行</dj-button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Vue from 'vue';\n// import codemirror from './codemirror';\n// import toHTML from 'vdom-to-html';\n\nexport default {\n  name: 'djCode',\n  // components: {codemirror},\n  props: {\n    type: String,\n    info: Object,\n    value: String,\n    title: String,\n    codeShow: {\n      type: Boolean,\n      default: true\n    },\n    data: {\n      type: Object,\n      default: () => {\n        return {};\n      }\n    },\n    options: Object,\n    index: Number\n  },\n  data() {\n    return {\n      code: this.setCode(),\n      showCode: false\n    };\n  },\n  watch: {\n    value: function(o, n) {\n      // this.code = this.value.replace(/ {4}/g, '');\n      // this.code = this.htmlFormat(this.value);\n      this.setCode();\n    }\n  },\n  mounted() {\n    this.insert();\n  },\n  methods: {\n    setCode() {\n      let scope1 = '<script>';\n      // </ script>这样写是为解决eslint 报错\n      let scope2 = '</ script>'.replace(' ', '');\n      if (this.data.data || this.data.methods) {\n        this.code = `${this.value}\n          ${scope1}\n          export default ${this.objToString(this.data)}\n          ${scope2}`;\n      } else {\n        this.code = `${this.value}\n          ${scope1}\n          export default {\n            data() {\n              return {\n              };\n            },\n            methods: {\n            }\n          }\n          ${scope2}`;\n      }\n      this.code = this.htmlFormat(this.code);\n      return this.code;\n    },\n    insert() {\n      if (!this.code) {\n        return;\n      }\n      let temp = this.code.split('<script>');\n      let code = temp[0].replace(/\\n/g, '').replace(/>( {1,})</g, '><');\n      let data = {};\n      let script = temp[1];\n      if (script && script.indexOf('export default ') > -1) {\n        script = script.substring(script.indexOf('{'), script.length);\n        script = script.replace('export default ', '').replace('</ script>'.replace(' ', ''), '');\n        // eslint-disable-next-line no-new-func\n        data = new Function(`return ${script}`)();\n      }\n      Vue.component(`block-code${this.index}`, {\n        template: `<div id=\"block-code${this.index}\" class=\"case-code\">` + code + '</div>',\n        ...data\n      });\n      const BlockCode = Vue.component(`block-code${this.index}`); // 只能查找到全局注册到组件\n      const instance = new BlockCode();\n      instance.$mount(`#block-code${this.index}`);\n    },\n    objToString(data) {\n      return `{\n        ` + Object.keys(data).map(key => {\n        if (typeof data[key] == 'function') {\n          return data[key].toString().replace('function ', '');\n        }\n        return key + ': ' + this.objToString(data[key]);\n      }).join(',\\n') + `\n      }`;\n    },\n    htmlFormat(html) { // 格式化html代码\n      // html.replace(/}/g, '}\\n');\n      if (!html) {\n        return;\n      }\n      let list = html.split('\\n');\n      let count = 0;\n      list = list.map(row => {\n        if (!row) {\n          return '';\n        }\n        let str = this.trim(row);\n        str = this.tabSize(str, count);\n        if (str.indexOf('<') > -1 && str.indexOf('<') != str.indexOf('</') || str.indexOf('{') > -1) {\n          count++;\n        }\n        if (str.indexOf('</') > -1 || str.indexOf('/>') > -1 || str.indexOf('}') > -1) {\n          count--;\n        }\n        return str;\n      });\n      return list.join('\\n');\n    },\n    trim(str) { // 去头尾空格\n      return this.trimLeft(this.trimRight(str));\n    },\n    trimLeft(str) { // 去头部空格\n      if (!str) {\n        return '';\n      }\n      if (str.indexOf(' ') == 0) {\n        return this.trimLeft(str.substring(1, str.length));\n      }\n      return str;\n    },\n    trimRight(str) { // 去末尾空格\n      if (!str) {\n        return '';\n      }\n      if (str.lastIndexOf(' ') == str.length - 1) {\n        return this.trimRight(str.substring(0, str.length - 1));\n      }\n      return str;\n    },\n    tabSize(str, size) { // 增加退格符\n      let count = size;\n      if (str.indexOf('</') == 0 || str.indexOf('/>') == 0 || str.indexOf('}') == 0) {\n        count--;\n      }\n      if (count <= 0) {\n        return str;\n      }\n      let tabStr = '';\n      for (let i = 0; i < count; i++) {\n        tabStr += '  ';\n      }\n      return tabStr + str;\n    }\n  }\n};\n</script>\n\n<style lang=\"less\">\n</style>\n"]}]}