{"remainingRequest":"/Users/wangjunxia/work-github/dj-design/node_modules/babel-loader/lib/index.js!/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/wangjunxia/work-github/dj-design/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangjunxia/work-github/dj-design/packages/image/src/imagePreview.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangjunxia/work-github/dj-design/packages/image/src/imagePreview.vue","mtime":1673509764327},{"path":"/Users/wangjunxia/work-github/dj-design/babel.config.js","mtime":1660011372032},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KbGV0IHByZXZPdmVyZmxvdyA9ICcnOwpsZXQgbW91c2V3aGVlbEV2ZW50TmFtZSA9ICdtb3VzZXdoZWVsJzsKCmlmIChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKSB7CiAgLy8gZmlyZWZveAogIG1vdXNld2hlZWxFdmVudE5hbWUgPSAnRE9NTW91c2VTY3JvbGwnOwp9IGVsc2UgewogIC8vIHdpbmRvdy5vbm1vdXNld2hlZWwgPSBkb2N1bWVudC5vbm1vdXNld2hlZWwgPSB0aGlzLnNjcm9sbEZ1bjsKICBtb3VzZXdoZWVsRXZlbnROYW1lID0gJ29ubW91c2V3aGVlbCc7Cn0gLy8gZnVuY3Rpb24gcmFmVGhyb3R0bGUoZm4pIHsKLy8gICBsZXQgbG9ja2VkID0gZmFsc2U7Ci8vICAgcmV0dXJuIGZ1bmN0aW9uKC4uLmFyZ3MpIHsKLy8gICAgIGlmIChsb2NrZWQpIHJldHVybjsKLy8gICAgIGxvY2tlZCA9IHRydWU7Ci8vICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKF8gPT4gewovLyAgICAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKLy8gICAgICAgbG9ja2VkID0gZmFsc2U7Ci8vICAgICB9KTsKLy8gICB9OwovLyB9CgoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdkakltYWdlUHJldmlldycsCiAgcHJvcHM6IHsKICAgIHByZXZpZXdTcmNMaXN0OiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0OiAoKSA9PiBbXQogICAgfSwKICAgIGluaXRpYWxJbmRleDogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDAKICAgIH0sCiAgICBtYXNrQ2xvc2FibGU6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfSwKICAgIHNob3dWaWV3ZXI6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfSwKICAgIC8vIOaYr+WQpuaYvuekuuS4i+i9vQogICAgZG93bmxvYWRTdGF0dXM6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfQogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhcHBlbmRUb0JvZHk6IHRydWUsCiAgICAgIGluZGV4OiB0aGlzLmluaXRpYWxJbmRleCwKICAgICAgdHJhbnNmb3JtOiB7CiAgICAgICAgc2NhbGU6IDEsCiAgICAgICAgZGVnOiAwLAogICAgICAgIGVuYWJsZVRyYW5zaXRpb246IGZhbHNlLAogICAgICAgIG9mZnNldFg6IDAsCiAgICAgICAgb2Zmc2V0WTogMAogICAgICB9CiAgICB9OwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBjdXJyZW50SW1nKCkgewogICAgICByZXR1cm4gdGhpcy5wcmV2aWV3U3JjTGlzdFt0aGlzLmluZGV4XTsKICAgIH0sCgogICAgaW1nU3R5bGUoKSB7CiAgICAgIGxldCBzdHlsZSA9IHt9OwogICAgICBzdHlsZS5tYXhXaWR0aCA9IHN0eWxlLm1heEhlaWdodCA9ICcxMDAlJzsKICAgICAgc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7dGhpcy50cmFuc2Zvcm0uc2NhbGV9KSByb3RhdGUoJHt0aGlzLnRyYW5zZm9ybS5kZWd9ZGVnKWA7CiAgICAgIHN0eWxlLnRyYW5zaXRpb24gPSB0aGlzLnRyYW5zZm9ybS5lbmFibGVUcmFuc2l0aW9uID8gJ3RyYW5zZm9ybSAuM3MnIDogJyc7CiAgICAgIHN0eWxlLm1hcmdpblRvcCA9IHRoaXMudHJhbnNmb3JtLm9mZnNldFkgKyAncHgnOwogICAgICBzdHlsZS5tYXJnaW5MZWZ0ID0gdGhpcy50cmFuc2Zvcm0ub2Zmc2V0WCArICdweCc7CiAgICAgIHJldHVybiBzdHlsZTsKICAgIH0sCgogICAgd3JhcHBlclN0eWxlKCkgewogICAgICBsZXQgc3R5bGUgPSB7fTsgLy8gc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZTNkKCR7dGhpcy50cmFuc2Zvcm0ub2Zmc2V0WCAvIDJ9cHgsICR7dGhpcy50cmFuc2Zvcm0ub2Zmc2V0WSAvIDJ9cHgsIDApYDsKCiAgICAgIHJldHVybiBzdHlsZTsKICAgIH0sCgogICAgdG9vbHRpcElkKCkgewogICAgICByZXR1cm4gYGRqLWltZy1wcmV2aWV3LSR7TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDApfWA7CiAgICB9CgogIH0sCiAgd2F0Y2g6IHsKICAgIHNob3dWaWV3ZXI6IHsKICAgICAgaGFuZGxlcigpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnNob3dWaWV3ZXIsICd0aGlzLnNob3dWaWV3ZXInKTsKICAgICAgICBpZiAodGhpcy5zaG93Vmlld2VyKSB7CiAgICAgICAgICB0aGlzLm9uKGRvY3VtZW50LCBtb3VzZXdoZWVsRXZlbnROYW1lLCB0aGlzLnNjcm9sbEZ1bik7CiAgICAgICAgICB0aGlzLm9uKGRvY3VtZW50LCAna2V5ZG93bicsIHRoaXMua2V5RG93bkhhbmRsZXIpOyAvLyBTYWZhcmnkuI5DaHJvbWXlsZ7kuo7lkIzkuIDnsbvlnosKCiAgICAgICAgICB3aW5kb3cub25tb3VzZXdoZWVsID0gZG9jdW1lbnQub25tb3VzZXdoZWVsID0gdGhpcy5zY3JvbGxGdW47CiAgICAgICAgICBwcmV2T3ZlcmZsb3cgPSBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93OwogICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gcHJldk92ZXJmbG93OwogICAgICAgIH0KICAgICAgfSwKCiAgICAgIGRlZXA6IHRydWUKICAgIH0sCiAgICBpbml0aWFsSW5kZXg6IHsKICAgICAgaGFuZGxlcigpIHsKICAgICAgICB0aGlzLmluZGV4ID0gdGhpcy5pbml0aWFsSW5kZXg7CiAgICAgIH0sCgogICAgICBkZWVwOiB0cnVlCiAgICB9CiAgfSwKCiAgbW91bnRlZCgpIHsKICAgIC8vIHRoaXMuZGV2aWNlU3VwcG9ydEluc3RhbGwoKTsKICAgIGlmICh0aGlzLmFwcGVuZFRvQm9keSkgewogICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuJGVsKTsKICAgIH0KICB9LAoKICBtZXRob2RzOiB7CiAgICBkb3dubG9hZCgpIHsKICAgICAgdmFyIF90aGlzJCRsaXN0ZW5lcnM7CgogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLiRsaXN0ZW5lcnMsICckbGlzdGVuZXJzJyk7CiAgICAgIGlmICgoX3RoaXMkJGxpc3RlbmVycyA9IHRoaXMuJGxpc3RlbmVycykgIT09IG51bGwgJiYgX3RoaXMkJGxpc3RlbmVycyAhPT0gdm9pZCAwICYmIF90aGlzJCRsaXN0ZW5lcnMuZG93bmxvYWQpIHsKICAgICAgICAvLyB0aGlzLmN1c3RvbURvd25sb2FkCiAgICAgICAgdGhpcy4kZW1pdCgnZG93bmxvYWQnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gY29uc29sZS5sb2coJ+WtkOe6p+WGhee9ruS4i+i9vScpOwogICAgICAvLyByZXR1cm47CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnJlYWNoYWJsZQoKCiAgICAgIHRoaXMuZG93bmxvYWRGdW4oKTsKICAgIH0sCgogICAgZG93bmxvYWRGdW4oKSB7CiAgICAgIGxldCBpbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMudG9vbHRpcElkKTsgLy8g6I635Y+W6KaB5LiL6L2955qE5Zu+54mHCgogICAgICBsZXQgaW1nVXJsID0gaW1hZ2Uuc3JjOyAvLyDojrflj5blm77niYflnLDlnYAKCiAgICAgIGxldCBpbWdVcmxBcnIgPSBpbWdVcmwgPT09IG51bGwgfHwgaW1nVXJsID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbWdVcmwuc3BsaXQoJy8nKTsKICAgICAgbGV0IGltZ1VybE5hbWUgPSBpbWdVcmxBcnJbKGltZ1VybEFyciA9PT0gbnVsbCB8fCBpbWdVcmxBcnIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGltZ1VybEFyci5sZW5ndGgpIC0gMV07CiAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgICAgeGhyLm9wZW4oJ2dldCcsIGltZ1VybCwgdHJ1ZSk7IC8vIOiHs+WFs+mHjeimgQoKICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdibG9iJzsKCiAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgLy8g5b6X5Yiw5LiA5LiqYmxvYuWvueixoQogICAgICAgICAgbGV0IGJsb2IgPSB0aGlzLnJlc3BvbnNlOyAvLyDoh7PlhbPph43opoEKCiAgICAgICAgICBsZXQgb0ZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoKICAgICAgICAgIG9GaWxlUmVhZGVyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGxldCBiYXNlNjQgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICAgIGxldCBlbGVMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgICAgICBlbGVMaW5rLmRvd25sb2FkID0gaW1nVXJsTmFtZTsKICAgICAgICAgICAgZWxlTGluay5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBlbGVMaW5rLmhyZWYgPSBiYXNlNjQ7IC8vIOinpuWPkeeCueWHuwoKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVMaW5rKTsKICAgICAgICAgICAgZWxlTGluay5jbGljaygpOyAvLyDnhLblkI7np7vpmaQKCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlTGluayk7CiAgICAgICAgICB9OwoKICAgICAgICAgIG9GaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwoYmxvYik7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgeGhyLnNlbmQoKTsKICAgICAgLyogbGV0IGltZ1VybFN1ZmZpeEFyciA9IGltZ1VybD8uc3BsaXQoJy4nKTsKICAgICAgbGV0IGltZ1VybFN1ZmZpeCA9IGltZ1VybFN1ZmZpeEFycltpbWdVcmxTdWZmaXhBcnI/Lmxlbmd0aCAtIDFdOwogICAgICBjb25zb2xlLmxvZyhpbWdVcmxOYW1lLCdpbWdVcmxOYW1lJyk7CiAgICAgIGltYWdlLnNldEF0dHJpYnV0ZSgnY3Jvc3NPcmlnaW4nLCAnYW5vbnltb3VzJyk7CiAgICAgIHRoaXMuZnVuRG93bmxvYWQoaW1hZ2UsIGltZ1VybE5hbWUsIGltZ1VybFN1ZmZpeCk7Ki8KICAgIH0sCgogICAgZnVuRG93bmxvYWQoZG9tSW1nLCBmaWxlbmFtZSwgc3VmZml4KSB7CiAgICAgIGxldCBjID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ215Q2FudmFzJyk7CiAgICAgIGxldCBjdHggPSBjLmdldENvbnRleHQoJzJkJyk7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGN0eC5kcmF3SW1hZ2UoZG9tSW1nLCAwLCAwKTsKICAgICAgfSwgMTApOyAvLyBjb25zb2xlLmxvZyhkb21JbWcsICdkb21JbWcnKTsKICAgICAgLy8g5Yib5bu66ZqQ6JeP55qE5Y+v5LiL6L296ZO+5o6lCgogICAgICB2YXIgZWxlTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgZWxlTGluay5kb3dubG9hZCA9IGZpbGVuYW1lOwogICAgICBlbGVMaW5rLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7IC8vIOWbvueJh+i9rGJhc2U2NOWcsOWdgAoKICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICB2YXIgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICB2YXIgd2lkdGggPSBkb21JbWcubmF0dXJhbFdpZHRoOwogICAgICAgIHZhciBoZWlnaHQgPSBkb21JbWcubmF0dXJhbEhlaWdodDsKICAgICAgICBjYW52YXMud2lkdGggPSB3aWR0aDsKICAgICAgICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0OyAvLyBjb25zb2xlLmxvZyhjYW52YXMsICdjYW52YXMnKTsKICAgICAgICAvLyBjb25zb2xlLmxvZyhjb250ZXh0LCAnY29udGV4dCcpOwoKICAgICAgICBjb250ZXh0LmRyYXdJbWFnZShkb21JbWcsIDAsIDApOyAvLyDlpoLmnpzmmK9QTkflm77niYfvvIzliJljYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKQogICAgICAgIC8vIGVsZUxpbmsuaHJlZiA9IGNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlLycgKyBzdWZmaXgpOwoKICAgICAgICBlbGVMaW5rLmhyZWYgPSBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9naWYnKTsgLy8g6Kem5Y+R54K55Ye7CgogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlTGluayk7CiAgICAgICAgZWxlTGluay5jbGljaygpOyAvLyDnhLblkI7np7vpmaQKCiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbGVMaW5rKTsKICAgICAgfSwgMTApOwogICAgfSwKCiAgICAvLyDmjInplK7kuovku7YKICAgIGtleURvd25IYW5kbGVyKGUpIHsKICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgY29uc3Qga2V5Q29kZSA9IGUua2V5Q29kZTsKCiAgICAgIHN3aXRjaCAoa2V5Q29kZSkgewogICAgICAgIC8vIEVTQwogICAgICAgIGNhc2UgMjc6CiAgICAgICAgICB0aGlzLmNsb3NlKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICAvLyDlt6bnrq3lpLQKCiAgICAgICAgY2FzZSAzNzoKICAgICAgICAgIHRoaXMucHJldigpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgLy8g5Y+z566t5aS0CgogICAgICAgIGNhc2UgMzk6CiAgICAgICAgICB0aGlzLm5leHQoKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9LAoKICAgIC8vIOiDjOaZr+eCueWHuwogICAgaGFuZGxlTWFza0NsaWNrKCkgewogICAgICAvLyBjb25zb2xlLmxvZygnaGFuZGxlTWFza0NsaWNrJyk7CiAgICAgIGlmICh0aGlzLm1hc2tDbG9zYWJsZSkgewogICAgICAgIHRoaXMuY2xvc2UoKTsKICAgICAgfQogICAgfSwKCiAgICAvLyDpvKDmoIfmu5rova7mu5rliqgKICAgIHNjcm9sbEZ1bihlKSB7CiAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsgLy8gY29uc29sZS5sb2coZSwgJ2VlZWVlZScpOwoKICAgICAgaWYgKGUud2hlZWxEZWx0YSkgewogICAgICAgIC8vIOWIpOaWrea1j+iniOWZqElF77yM6LC35q2M5ruR6L2u5LqL5Lu2CiAgICAgICAgaWYgKGUud2hlZWxEZWx0YSA+IDApIHsKICAgICAgICAgIC8vIOW9k+a7kei9ruWQkeS4iua7muWKqOaXtgogICAgICAgICAgLy8gY29uc29sZS5sb2coJ+S4iua7miBJRe+8jOiwt+atjCcpOwogICAgICAgICAgdGhpcy5oYW5kbGVBY3Rpb25zKCd6b29tSW4nLCB7CiAgICAgICAgICAgIHpvb21SYXRlOiAwLjAxNSwKICAgICAgICAgICAgZW5hYmxlVHJhbnNpdGlvbjogZmFsc2UKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKGUud2hlZWxEZWx0YSA8IDApIHsKICAgICAgICAgIC8vIOW9k+a7kei9ruWQkeS4i+a7muWKqOaXtgogICAgICAgICAgLy8gY29uc29sZS5sb2coJ+S4i+a7miBJRe+8jOiwt+atjCcpOwogICAgICAgICAgdGhpcy5oYW5kbGVBY3Rpb25zKCd6b29tT3V0JywgewogICAgICAgICAgICB6b29tUmF0ZTogMC4wMTUsCiAgICAgICAgICAgIGVuYWJsZVRyYW5zaXRpb246IGZhbHNlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZS5kZXRhaWwpIHsKICAgICAgICAvLyBGaXJlZm945ruR6L2u5LqL5Lu2CiAgICAgICAgaWYgKGUuZGV0YWlsID4gMCkgewogICAgICAgICAgLy8g5b2T5ruR6L2u5ZCR5LiL5rua5Yqo5pe2CiAgICAgICAgICB0aGlzLmhhbmRsZUFjdGlvbnMoJ3pvb21PdXQnLCB7CiAgICAgICAgICAgIHpvb21SYXRlOiAwLjAxNSwKICAgICAgICAgICAgZW5hYmxlVHJhbnNpdGlvbjogZmFsc2UKICAgICAgICAgIH0pOyAvLyBjb25zb2xlLmxvZygn5LiL5ruaIEZpcmVmb3gnKTsKICAgICAgICB9CgogICAgICAgIGlmIChlLmRldGFpbCA8IDApIHsKICAgICAgICAgIC8vIOW9k+a7kei9ruWQkeS4iua7muWKqOaXtgogICAgICAgICAgdGhpcy5oYW5kbGVBY3Rpb25zKCd6b29tSW4nLCB7CiAgICAgICAgICAgIHpvb21SYXRlOiAwLjAxNSwKICAgICAgICAgICAgZW5hYmxlVHJhbnNpdGlvbjogZmFsc2UKICAgICAgICAgIH0pOyAvLyBjb25zb2xlLmxvZygn5LiK5ruaIEZpcmVmb3gnKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgLy8g5Yqo5L2cCiAgICBoYW5kbGVBY3Rpb25zKGFjdGlvbiwgb3B0aW9ucykgewogICAgICBsZXQgdHJhbnNmb3JtID0gdGhpcy50cmFuc2Zvcm07CiAgICAgIGxldCB7CiAgICAgICAgZW5hYmxlVHJhbnNpdGlvbiwKICAgICAgICB6b29tUmF0ZSwKICAgICAgICByb3RhdGVEZWcKICAgICAgfSA9IHsKICAgICAgICB6b29tUmF0ZTogMC4yLAogICAgICAgIHJvdGF0ZURlZzogOTAsCiAgICAgICAgZW5hYmxlVHJhbnNpdGlvbjogdHJ1ZSwKICAgICAgICAuLi5vcHRpb25zCiAgICAgIH07CgogICAgICBzd2l0Y2ggKGFjdGlvbikgewogICAgICAgIGNhc2UgJ3pvb21PdXQnOgogICAgICAgICAgaWYgKHRyYW5zZm9ybS5zY2FsZSA+IDAuMikgewogICAgICAgICAgICB0cmFuc2Zvcm0uc2NhbGUgPSBwYXJzZUZsb2F0KCh0cmFuc2Zvcm0uc2NhbGUgLSB6b29tUmF0ZSkudG9GaXhlZCgzKSk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ3pvb21Jbic6CiAgICAgICAgICB0cmFuc2Zvcm0uc2NhbGUgPSBwYXJzZUZsb2F0KCh0cmFuc2Zvcm0uc2NhbGUgKyB6b29tUmF0ZSkudG9GaXhlZCgzKSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAncm90YXRlUmlnaHQnOgogICAgICAgICAgdHJhbnNmb3JtLmRlZyArPSByb3RhdGVEZWc7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAncm90YXRlTGVmdCc6CiAgICAgICAgICB0cmFuc2Zvcm0uZGVnIC09IHJvdGF0ZURlZzsKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICB0aGlzLnRyYW5zZm9ybS5lbmFibGVUcmFuc2l0aW9uID0gZW5hYmxlVHJhbnNpdGlvbjsKCiAgICAgIGlmIChhY3Rpb24gPT09ICdyb3RhdGVSaWdodCcgfHwgYWN0aW9uID09PSAncm90YXRlTGVmdCcpIHsKICAgICAgICB0aGlzLiRlbWl0KCdoYW5kbGVBY3Rpb25zJywgYWN0aW9uKTsKICAgICAgfQogICAgfSwKCiAgICBoYW5kbGVNb3VzZURvd24oZSkgewogICAgICAvLyDlj6rmnInlt6bplK7miY3miafooYzkuIvpnaLnmoTlhoXlrrkKICAgICAgaWYgKGUuYnV0dG9uICE9PSAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy50b29sdGlwSWQpKSB7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy50b29sdGlwSWQpLnN0eWxlLmN1cnNvciA9ICdncmFiYmluZyc7CiAgICAgIH0KCiAgICAgIGxldCBzdGFydFggPSBlLnBhZ2VYOwogICAgICBsZXQgc3RhcnRZID0gZS5wYWdlWTsgLy8gY29uc29sZS5sb2coZSwgc3RhcnRYLCBzdGFydFksICdoYW5kbGVNb3VzZURvd24nKTsKCiAgICAgIGxldCB7CiAgICAgICAgb2Zmc2V0WCwKICAgICAgICBvZmZzZXRZCiAgICAgIH0gPSB0aGlzLnRyYW5zZm9ybTsgLy8gbGV0IG8gPSBlLnRhcmdldDsgIC8vIOiOt+WPluW9k+WJjeaLluaUvueahOWFg+e0oAogICAgICAvLyBsZXQgb3ggPSBwYXJzZUludChvLm9mZnNldExlZnQpOyAgLy8g5ouW5pS+5YWD57Sg55qEeOi9tOWdkOaghwogICAgICAvLyBsZXQgb3kgPSBwYXJzZUludChvLm9mZnNldFRvcCk7ICAvLyDmi5bmlL7lhYPntKDnmoR56L205Z2Q5qCHCiAgICAgIC8vIHRoaXMuZHJhZ0Z1biA9IHJhZlRocm90dGxlKGV2ID0+IHsKICAgICAgLy8gICBjb25zb2xlLmxvZyhldiwnZXYtLS0tLS0tLS0tLS0tLScpOwogICAgICAvLyAgIGNvbnNvbGUubG9nKG9mZnNldFgsIGV2LnBhZ2VYLCBzdGFydFgsICdkcmFnRnVuIHh4eCcpOwogICAgICAvLyAgIGNvbnNvbGUubG9nKG9mZnNldFksIGV2LnBhZ2VZLCBzdGFydFksICdkcmFnRnVuIHl5eScpOwogICAgICAvLyAgIHRoaXMudHJhbnNmb3JtLm9mZnNldFggPSBvZmZzZXRYICsgZXYucGFnZVggLSBzdGFydFg7CiAgICAgIC8vICAgdGhpcy50cmFuc2Zvcm0ub2Zmc2V0WSA9IG9mZnNldFkgKyBldi5wYWdlWSAtIHN0YXJ0WTsKICAgICAgLy8gICBjb25zb2xlLmxvZyh0aGlzLnRyYW5zZm9ybS5vZmZzZXRYLCB0aGlzLnRyYW5zZm9ybS5vZmZzZXRZLCAndGhpcy50cmFuc2Zvcm0ub2Zmc2V0WCcpOwogICAgICAvLyB9KTsKCiAgICAgIHRoaXMuZHJhZ0Z1biA9IGV2ID0+IHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhvZmZzZXRYLCBldi5wYWdlWCwgc3RhcnRYLCAnZHJhZ0Z1biB4eHgnKTsKICAgICAgICAvLyBjb25zb2xlLmxvZyhvZmZzZXRZLCBldi5wYWdlWSwgc3RhcnRZLCAnZHJhZ0Z1biB5eXknKTsKICAgICAgICB0aGlzLnRyYW5zZm9ybS5vZmZzZXRYID0gb2Zmc2V0WCArIGV2LnBhZ2VYIC0gc3RhcnRYOwogICAgICAgIHRoaXMudHJhbnNmb3JtLm9mZnNldFkgPSBvZmZzZXRZICsgZXYucGFnZVkgLSBzdGFydFk7IC8vIGNvbnNvbGUubG9nKHRoaXMudHJhbnNmb3JtLm9mZnNldFgsIHRoaXMudHJhbnNmb3JtLm9mZnNldFksICd0aGlzLnRyYW5zZm9ybS5vZmZzZXRYJyk7CiAgICAgIH07CgogICAgICB0aGlzLm9uKGRvY3VtZW50LCAnbW91c2Vtb3ZlJywgdGhpcy5kcmFnRnVuKTsKICAgICAgdGhpcy5vbihkb2N1bWVudCwgJ21vdXNldXAnLCBldiA9PiB7CiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMudG9vbHRpcElkKSkgewogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy50b29sdGlwSWQpLnN0eWxlLmN1cnNvciA9ICdncmFiJzsKICAgICAgICB9CgogICAgICAgIHRoaXMub2ZmKGRvY3VtZW50LCAnbW91c2Vtb3ZlJywgdGhpcy5kcmFnRnVuKTsKICAgICAgfSk7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIH0sCgogICAgcmVzZXQoKSB7CiAgICAgIHRoaXMudHJhbnNmb3JtID0gewogICAgICAgIHNjYWxlOiAxLAogICAgICAgIGRlZzogMCwKICAgICAgICBlbmFibGVUcmFuc2l0aW9uOiBmYWxzZSwKICAgICAgICBvZmZzZXRYOiAwLAogICAgICAgIG9mZnNldFk6IDAKICAgICAgfTsKICAgIH0sCgogICAgcHJldigpIHsKICAgICAgdmFyIF90aGlzJHByZXZpZXdTcmNMaXN0LCBfdGhpcyRwcmV2aWV3U3JjTGlzdDI7CgogICAgICB0aGlzLmluZGV4ID0gKHRoaXMuaW5kZXggLSAxICsgKChfdGhpcyRwcmV2aWV3U3JjTGlzdCA9IHRoaXMucHJldmlld1NyY0xpc3QpID09PSBudWxsIHx8IF90aGlzJHByZXZpZXdTcmNMaXN0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRwcmV2aWV3U3JjTGlzdC5sZW5ndGgpKSAlICgoX3RoaXMkcHJldmlld1NyY0xpc3QyID0gdGhpcy5wcmV2aWV3U3JjTGlzdCkgPT09IG51bGwgfHwgX3RoaXMkcHJldmlld1NyY0xpc3QyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRwcmV2aWV3U3JjTGlzdDIubGVuZ3RoKTsKICAgICAgdGhpcy5yZXNldCgpOwogICAgfSwKCiAgICBuZXh0KCkgewogICAgICB2YXIgX3RoaXMkcHJldmlld1NyY0xpc3QzOwoKICAgICAgdGhpcy5pbmRleCA9ICh0aGlzLmluZGV4ICsgMSkgJSAoKF90aGlzJHByZXZpZXdTcmNMaXN0MyA9IHRoaXMucHJldmlld1NyY0xpc3QpID09PSBudWxsIHx8IF90aGlzJHByZXZpZXdTcmNMaXN0MyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkcHJldmlld1NyY0xpc3QzLmxlbmd0aCk7CiAgICAgIHRoaXMucmVzZXQoKTsKICAgIH0sCgogICAgY2xvc2UoKSB7CiAgICAgIHRoaXMucmVzZXQoKTsKICAgICAgdGhpcy5vZmYoZG9jdW1lbnQsIG1vdXNld2hlZWxFdmVudE5hbWUsIHRoaXMuc2Nyb2xsRnVuKTsKICAgICAgdGhpcy5vZmYoZG9jdW1lbnQsICdrZXlkb3duJywgdGhpcy5rZXlEb3duSGFuZGxlcik7IC8vIHRoaXMuc2Nyb2xsRnVuID0gbnVsbDsKCiAgICAgIHdpbmRvdy5vbm1vdXNld2hlZWwgPSBkb2N1bWVudC5vbm1vdXNld2hlZWwgPSBudWxsOwogICAgICB0aGlzLiRlbWl0KCdvbkNsb3NlJyk7CiAgICB9LAoKICAgIG9mZihlbGVtZW50LCBldmVudCwgaGFuZGxlcikgewogICAgICAvLyBjb25zb2xlLmxvZyhlbGVtZW50LCBldmVudCwgJ29mZicpOwogICAgICBpZiAoZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcikgewogICAgICAgIGlmIChlbGVtZW50ICYmIGV2ZW50KSB7CiAgICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIGZhbHNlKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuZGV0YWNoRXZlbnQpIHsKICAgICAgICBpZiAoZWxlbWVudCAmJiBldmVudCkgewogICAgICAgICAgZWxlbWVudC5kZXRhY2hFdmVudCgnb24nICsgZXZlbnQsIGhhbmRsZXIpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICBvbihlbGVtZW50LCBldmVudCwgaGFuZGxlcikgewogICAgICAvLyBjb25zb2xlLmxvZyhlbGVtZW50LCBldmVudCwgaGFuZGxlciwgJ29uJyk7CiAgICAgIC8vIGNvbnNvbGUubG9nKGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIsICdvbicpOwogICAgICBpZiAoZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcikgewogICAgICAgIC8vIGZpcmVmb3gKICAgICAgICAvLyBjb25zb2xlLmxvZygnMTExJyk7CiAgICAgICAgaWYgKGVsZW1lbnQgJiYgZXZlbnQgJiYgaGFuZGxlcikgewogICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBmYWxzZSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGRvY3VtZW50LmF0dGFjaEV2ZW50KSB7CiAgICAgICAgLy8gY29uc29sZS5sb2coJzIyMicpOwogICAgICAgIGlmIChlbGVtZW50ICYmIGV2ZW50ICYmIGhhbmRsZXIpIHsKICAgICAgICAgIGVsZW1lbnQuYXR0YWNoRXZlbnQoJ29uJyArIGV2ZW50LCBoYW5kbGVyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfSwKCiAgZGVzdHJveWVkKCkgewogICAgLy8gaWYgYXBwZW5kVG9Cb2R5IGlzIHRydWUsIHJlbW92ZSBET00gbm9kZSBhZnRlciBkZXN0cm95CiAgICBpZiAodGhpcy5hcHBlbmRUb0JvZHkgJiYgdGhpcy4kZWwgJiYgdGhpcy4kZWwucGFyZW50Tm9kZSkgewogICAgICB0aGlzLiRlbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuJGVsKTsKICAgIH0KICB9Cgp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;;AACA;EAAA;EACAA;AACA,CAFA,MAEA;EACA;EACAA;AACA,C,CACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA;EACAC,sBADA;EAEAC;IACAC;MACAC,WADA;MAEAC;IAFA,CADA;IAKAC;MACAF,YADA;MAEAC;IAFA,CALA;IASAE;MACAH,aADA;MAEAC;IAFA,CATA;IAaAG;MACAJ,aADA;MAEAC;IAFA,CAbA;IAiBA;IACAI;MACAL,aADA;MAEAC;IAFA;EAlBA,CAFA;;EAyBAK;IACA;MACAC,kBADA;MAEAC,wBAFA;MAGAC;QACAC,QADA;QAEAC,MAFA;QAGAC,uBAHA;QAIAC,UAJA;QAKAC;MALA;IAHA;EAWA,CArCA;;EAsCAC;IACAC;MACA;IACA,CAHA;;IAIAC;MACA;MACAC;MACAA;MACAA;MACAA;MACAA;MACA;IACA,CAZA;;IAaAC;MACA,eADA,CAEA;;MACA;IACA,CAjBA;;IAkBAC;MACA;IACA;;EApBA,CAtCA;EA4DAC;IACAjB;MACAkB;QACA;QACA;UACA;UACA,kDAFA,CAGA;;UACAC;UACAC;UACAC;QACA,CAPA,MAOA;UACAA;QACA;MACA,CAbA;;MAcAC;IAdA,CADA;IAiBAxB;MACAoB;QACA;MACA,CAHA;;MAIAI;IAJA;EAjBA,CA5DA;;EAoFAC;IACA;IACA;MACAF;IACA;EACA,CAzFA;;EA0FAG;IACAC;MAAA;;MACA;MACA;QAAA;QACA;QACA;MACA,CALA,CAMA;MACA;MACA;;;MACA;IACA,CAXA;;IAYAC;MACA,oDADA,CACA;;MACA,uBAFA,CAEA;;MACA;MACA;MACA;MACAC,8BANA,CAOA;;MACAA;;MACAA;QACA;UACA;UACA,yBAFA,CAGA;;UACA;;UACAC;YACA;YACA;YACAC;YACAA;YACAA,sBALA,CAMA;;YACAR;YACAQ,gBARA,CASA;;YACAR;UACA,CAXA;;UAYAO;QACA;MACA,CApBA;;MAqBAD;MACA;AACA;AACA;AACA;AACA;IACA,CAhDA;;IAiDAG;MACA;MACA;MACAC;QACAC;MACA,CAFA,EAEA,EAFA,EAHA,CAMA;MACA;;MACA;MACAH;MACAA,+BAVA,CAWA;;MACA;MACA;MACAE;QACA;QACA;QACAE;QACAA,uBAJA,CAKA;QACA;;QACAC,gCAPA,CAQA;QACA;;QACAL,6CAVA,CAWA;;QACAR;QACAQ,gBAbA,CAcA;;QACAR;MACA,CAhBA,EAgBA,EAhBA;IAiBA,CAhFA;;IAiFA;IACAc;MACAC;MACA;;MACA;QACA;QACA;UACA;UACA;QACA;;QACA;UACA;UACA;QACA;;QACA;UACA;UACA;MAZA;IAcA,CAnGA;;IAoGA;IACAC;MACA;MACA;QACA;MACA;IACA,CA1GA;;IA2GA;IACAC;MACAF,sBADA,CAEA;;MACA;QAAA;QACA;UAAA;UACA;UACA;YAAAG;YAAA/B;UAAA;QACA;;QACA;UAAA;UACA;UACA;YAAA+B;YAAA/B;UAAA;QACA;MACA,CATA,MASA;QAAA;QACA;UAAA;UACA;YAAA+B;YAAA/B;UAAA,GADA,CAEA;QACA;;QACA;UAAA;UACA;YAAA+B;YAAA/B;UAAA,GADA,CAEA;QACA;MACA;IACA,CAlIA;;IAmIA;IACAgC;MACA;MACA;QAAAhC;QAAA+B;QAAAE;MAAA;QACAF,aADA;QAEAE,aAFA;QAGAjC,sBAHA;QAIA;MAJA;;MAMA;QACA;UACA;YACAH;UACA;;UACA;;QACA;UACAA;UACA;;QACA;UACAA;UACA;;QACA;UACAA;UACA;MAdA;;MAgBA;;MACA;QACA;MACA;IACA,CAhKA;;IAiKAqC;MACA;MACA;QACA;MACA;;MACA;QACArB;MACA;;MACA;MACA,qBATA,CAUA;;MACA;QAAAZ;QAAAC;MAAA,mBAXA,CAYA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MACA;QACA;QACA;QACA;QACA,qDAJA,CAKA;MACA,CANA;;MAOA;MACA;QACA;UACAW;QACA;;QACA;MACA,CALA;MAMAe;IACA,CAvMA;;IAwMAO;MACA;QACArC,QADA;QAEAC,MAFA;QAGAC,uBAHA;QAIAC,UAJA;QAKAC;MALA;IAOA,CAhNA;;IAiNAkC;MAAA;;MACA;MACA;IACA,CApNA;;IAqNAC;MAAA;;MACA;MACA;IACA,CAxNA;;IAyNAC;MACA;MACA;MACA,mDAHA,CAIA;;MACA3B;MACA;IACA,CAhOA;;IAiOA4B;MACA;MACA;QACA;UACAC;QACA;MACA,CAJA,MAIA;QACA;UACAA;QACA;MACA;IACA,CA5OA;;IA6OAC;MACA;MACA;MACA;QAAA;QACA;QACA;UACAD;QACA;MACA,CALA,MAKA;QACA;QACA;UACAA;QACA;MACA;IACA;;EA3PA,CA1FA;;EAuVAE;IACA;IACA;MACA;IACA;EACA;;AA5VA","names":["mousewheelEventName","name","props","previewSrcList","type","default","initialIndex","maskClosable","showViewer","downloadStatus","data","appendToBody","index","transform","scale","deg","enableTransition","offsetX","offsetY","computed","currentImg","imgStyle","style","wrapperStyle","tooltipId","watch","handler","window","prevOverflow","document","deep","mounted","methods","download","downloadFun","xhr","oFileReader","eleLink","funDownload","setTimeout","ctx","canvas","context","keyDownHandler","e","handleMaskClick","scrollFun","zoomRate","handleActions","rotateDeg","handleMouseDown","reset","prev","next","close","off","element","on","destroyed"],"sourceRoot":"packages/image/src","sources":["imagePreview.vue"],"sourcesContent":["<template>\n  <transition name=\"viewer-fade\">\n    <div ref=\"dj-image-preview-wrap\" class=\"dj-image-preview-wrap\" v-if=\"showViewer\">\n      <div class=\"dj-image-preview-mask\" @click.self=\"handleMaskClick\"></div>\n      <div class=\"dj-image-preview-operations\">\n        <div class=\"dj-image-preview-operations-operation\" @click=\"close\">\n          <i class=\"iconfont close\"></i>\n        </div>\n        <div class=\"dj-image-preview-operations-operation\" @click=\"handleActions('zoomIn')\">\n          <i class=\"iconfont zoom-in\"></i>\n        </div>\n        <div class=\"dj-image-preview-operations-operation\" @click=\"handleActions('zoomOut')\">\n          <i class=\"iconfont zoom-out\"></i>\n        </div>\n        <div class=\"dj-image-preview-operations-operation\" @click=\"handleActions('rotateRight')\">\n          <i class=\"iconfont rotate-right\"></i>\n        </div>\n        <div class=\"dj-image-preview-operations-operation\" @click=\"handleActions('rotateLeft')\">\n          <i class=\"iconfont rotate-left\"></i>\n        </div>\n        <div v-if=\"downloadStatus\" class=\"dj-image-preview-operations-operation\" @click=\"download\">\n          <i class=\"iconfont download\"></i>\n        </div>\n      </div>\n      <div v-if=\"previewSrcList && previewSrcList.length > 1\" class=\"dj-image-preview-switch-left\" @click=\"prev\">\n        <i class=\"iconfont arrow-left f30\"></i>\n      </div>\n      <div v-if=\"previewSrcList && previewSrcList.length > 1\" class=\"dj-image-preview-switch-right\" @click=\"next\">\n        <i class=\"iconfont arrow-right f30\"></i>\n      </div>\n      <div class=\"dj-img-preview-wrapper\" :style=\"wrapperStyle\">\n        <img :src=\"currentImg\" alt=\"\" :style=\"imgStyle\" :id=\"tooltipId\" @mousedown=\"handleMouseDown\">\n      </div>\n    </div>\n  </transition>\n</template>\n\n<script>\nlet prevOverflow = '';\nlet mousewheelEventName = 'mousewheel';\nif (document.addEventListener) {// firefox\n  mousewheelEventName = 'DOMMouseScroll';\n} else {\n  // window.onmousewheel = document.onmousewheel = this.scrollFun;\n  mousewheelEventName = 'onmousewheel';\n}\n// function rafThrottle(fn) {\n//   let locked = false;\n//   return function(...args) {\n//     if (locked) return;\n//     locked = true;\n//     window.requestAnimationFrame(_ => {\n//       fn.apply(this, args);\n//       locked = false;\n//     });\n//   };\n// }\nexport default {\n  name: 'djImagePreview',\n  props: {\n    previewSrcList: {\n      type: Array,\n      default: () => []\n    },\n    initialIndex: {\n      type: Number,\n      default: 0\n    },\n    maskClosable: {\n      type: Boolean,\n      default: true\n    },\n    showViewer: {\n      type: Boolean,\n      default: true\n    },\n    // 是否显示下载\n    downloadStatus: {\n      type: Boolean,\n      default: true\n    }\n  },\n  data() {\n    return {\n      appendToBody: true,\n      index: this.initialIndex,\n      transform: {\n        scale: 1,\n        deg: 0,\n        enableTransition: false,\n        offsetX: 0,\n        offsetY: 0\n      }\n    };\n  },\n  computed: {\n    currentImg() {\n      return this.previewSrcList[this.index];\n    },\n    imgStyle() {\n      let style = {};\n      style.maxWidth = style.maxHeight = '100%';\n      style.transform = `scale(${this.transform.scale}) rotate(${this.transform.deg}deg)`;\n      style.transition = this.transform.enableTransition ? 'transform .3s' : '';\n      style.marginTop = this.transform.offsetY + 'px';\n      style.marginLeft = this.transform.offsetX + 'px';\n      return style;\n    },\n    wrapperStyle() {\n      let style = {};\n      // style.transform = `translate3d(${this.transform.offsetX / 2}px, ${this.transform.offsetY / 2}px, 0)`;\n      return style;\n    },\n    tooltipId() {\n      return `dj-img-preview-${Math.floor(Math.random() * 10000)}`;\n    }\n  },\n  watch: {\n    showViewer: {\n      handler() {\n        // console.log(this.showViewer, 'this.showViewer');\n        if (this.showViewer) {\n          this.on(document, mousewheelEventName, this.scrollFun);\n          this.on(document, 'keydown', this.keyDownHandler);\n          // Safari与Chrome属于同一类型\n          window.onmousewheel = document.onmousewheel = this.scrollFun;\n          prevOverflow = document.body.style.overflow;\n          document.body.style.overflow = 'hidden';\n        } else {\n          document.body.style.overflow = prevOverflow;\n        }\n      },\n      deep: true\n    },\n    initialIndex: {\n      handler() {\n        this.index = this.initialIndex;\n      },\n      deep: true\n    }\n  },\n  mounted() {\n    // this.deviceSupportInstall();\n    if (this.appendToBody) {\n      document.body.appendChild(this.$el);\n    }\n  },\n  methods: {\n    download() {\n      // console.log(this.$listeners, '$listeners');\n      if (this.$listeners?.download) {// this.customDownload\n        this.$emit('download');\n        return;\n      }\n      // console.log('子级内置下载');\n      // return;\n      // eslint-disable-next-line no-unreachable\n      this.downloadFun();\n    },\n    downloadFun() {\n      let image = document.getElementById(this.tooltipId); // 获取要下载的图片\n      let imgUrl = image.src; // 获取图片地址\n      let imgUrlArr = imgUrl?.split('/');\n      let imgUrlName = imgUrlArr[imgUrlArr?.length - 1];\n      var xhr = new XMLHttpRequest();\n      xhr.open('get', imgUrl, true);\n      // 至关重要\n      xhr.responseType = 'blob';\n      xhr.onload = function() {\n        if (this.status == 200) {\n          // 得到一个blob对象\n          let blob = this.response;\n          // 至关重要\n          let oFileReader = new FileReader();\n          oFileReader.onloadend = function(e) {\n            let base64 = e.target.result;\n            let eleLink = document.createElement('a');\n            eleLink.download = imgUrlName;\n            eleLink.style.display = 'none';\n            eleLink.href = base64;\n            // 触发点击\n            document.body.appendChild(eleLink);\n            eleLink.click();\n            // 然后移除\n            document.body.removeChild(eleLink);\n          };\n          oFileReader.readAsDataURL(blob);\n        }\n      };\n      xhr.send();\n      /* let imgUrlSuffixArr = imgUrl?.split('.');\n      let imgUrlSuffix = imgUrlSuffixArr[imgUrlSuffixArr?.length - 1];\n      console.log(imgUrlName,'imgUrlName');\n      image.setAttribute('crossOrigin', 'anonymous');\n      this.funDownload(image, imgUrlName, imgUrlSuffix);*/\n    },\n    funDownload(domImg, filename, suffix) {\n      let c = document.getElementById('myCanvas');\n      let ctx = c.getContext('2d');\n      setTimeout(() => {\n        ctx.drawImage(domImg, 0, 0);\n      }, 10);\n      // console.log(domImg, 'domImg');\n      // 创建隐藏的可下载链接\n      var eleLink = document.createElement('a');\n      eleLink.download = filename;\n      eleLink.style.display = 'none';\n      // 图片转base64地址\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      setTimeout(() => {\n        var width = domImg.naturalWidth;\n        var height = domImg.naturalHeight;\n        canvas.width = width;\n        canvas.height = height;\n        // console.log(canvas, 'canvas');\n        // console.log(context, 'context');\n        context.drawImage(domImg, 0, 0);\n        // 如果是PNG图片，则canvas.toDataURL('image/png')\n        // eleLink.href = canvas.toDataURL('image/' + suffix);\n        eleLink.href = canvas.toDataURL('image/gif');\n        // 触发点击\n        document.body.appendChild(eleLink);\n        eleLink.click();\n        // 然后移除\n        document.body.removeChild(eleLink);\n      }, 10);\n    },\n    // 按键事件\n    keyDownHandler(e) {\n      e.stopPropagation();\n      const keyCode = e.keyCode;\n      switch (keyCode) {\n        // ESC\n        case 27:\n          this.close();\n          break;\n        // 左箭头\n        case 37:\n          this.prev();\n          break;\n        // 右箭头\n        case 39:\n          this.next();\n          break;\n      }\n    },\n    // 背景点击\n    handleMaskClick() {\n      // console.log('handleMaskClick');\n      if (this.maskClosable) {\n        this.close();\n      }\n    },\n    // 鼠标滚轮滚动\n    scrollFun(e) {\n      e = e || window.event;\n      // console.log(e, 'eeeeee');\n      if (e.wheelDelta) {// 判断浏览器IE，谷歌滑轮事件\n        if (e.wheelDelta > 0) {// 当滑轮向上滚动时\n          // console.log('上滚 IE，谷歌');\n          this.handleActions('zoomIn', { zoomRate: 0.015, enableTransition: false });\n        }\n        if (e.wheelDelta < 0) {// 当滑轮向下滚动时\n          // console.log('下滚 IE，谷歌');\n          this.handleActions('zoomOut', { zoomRate: 0.015, enableTransition: false });\n        }\n      } else if (e.detail) {// Firefox滑轮事件\n        if (e.detail > 0) {// 当滑轮向下滚动时\n          this.handleActions('zoomOut', { zoomRate: 0.015, enableTransition: false });\n          // console.log('下滚 Firefox');\n        }\n        if (e.detail < 0) {// 当滑轮向上滚动时\n          this.handleActions('zoomIn', { zoomRate: 0.015, enableTransition: false });\n          // console.log('上滚 Firefox');\n        }\n      }\n    },\n    // 动作\n    handleActions(action, options) {\n      let transform = this.transform;\n      let { enableTransition, zoomRate, rotateDeg } = {\n        zoomRate: 0.2,\n        rotateDeg: 90,\n        enableTransition: true,\n        ...options\n      };\n      switch (action) {\n        case 'zoomOut':\n          if (transform.scale > 0.2) {\n            transform.scale = parseFloat((transform.scale - zoomRate).toFixed(3));\n          }\n          break;\n        case 'zoomIn':\n          transform.scale = parseFloat((transform.scale + zoomRate).toFixed(3));\n          break;\n        case 'rotateRight':\n          transform.deg += rotateDeg;\n          break;\n        case 'rotateLeft':\n          transform.deg -= rotateDeg;\n          break;\n      }\n      this.transform.enableTransition = enableTransition;\n      if (action === 'rotateRight' || action === 'rotateLeft') {\n        this.$emit('handleActions', action);\n      }\n    },\n    handleMouseDown(e) {\n      // 只有左键才执行下面的内容\n      if (e.button !== 0) {\n        return;\n      }\n      if (document.getElementById(this.tooltipId)) {\n        document.getElementById(this.tooltipId).style.cursor = 'grabbing';\n      }\n      let startX = e.pageX;\n      let startY = e.pageY;\n      // console.log(e, startX, startY, 'handleMouseDown');\n      let { offsetX, offsetY } = this.transform;\n      // let o = e.target;  // 获取当前拖放的元素\n      // let ox = parseInt(o.offsetLeft);  // 拖放元素的x轴坐标\n      // let oy = parseInt(o.offsetTop);  // 拖放元素的y轴坐标\n      // this.dragFun = rafThrottle(ev => {\n      //   console.log(ev,'ev--------------');\n      //   console.log(offsetX, ev.pageX, startX, 'dragFun xxx');\n      //   console.log(offsetY, ev.pageY, startY, 'dragFun yyy');\n      //   this.transform.offsetX = offsetX + ev.pageX - startX;\n      //   this.transform.offsetY = offsetY + ev.pageY - startY;\n      //   console.log(this.transform.offsetX, this.transform.offsetY, 'this.transform.offsetX');\n      // });\n      this.dragFun = (ev) => {\n        // console.log(offsetX, ev.pageX, startX, 'dragFun xxx');\n        // console.log(offsetY, ev.pageY, startY, 'dragFun yyy');\n        this.transform.offsetX = offsetX + ev.pageX - startX;\n        this.transform.offsetY = offsetY + ev.pageY - startY;\n        // console.log(this.transform.offsetX, this.transform.offsetY, 'this.transform.offsetX');\n      };\n      this.on(document, 'mousemove', this.dragFun);\n      this.on(document, 'mouseup', ev => {\n        if (document.getElementById(this.tooltipId)) {\n          document.getElementById(this.tooltipId).style.cursor = 'grab';\n        }\n        this.off(document, 'mousemove', this.dragFun);\n      });\n      e.preventDefault();\n    },\n    reset() {\n      this.transform = {\n        scale: 1,\n        deg: 0,\n        enableTransition: false,\n        offsetX: 0,\n        offsetY: 0\n      };\n    },\n    prev() {\n      this.index = (this.index - 1 + this.previewSrcList?.length) % this.previewSrcList?.length;\n      this.reset();\n    },\n    next() {\n      this.index = (this.index + 1) % this.previewSrcList?.length;\n      this.reset();\n    },\n    close() {\n      this.reset();\n      this.off(document, mousewheelEventName, this.scrollFun);\n      this.off(document, 'keydown', this.keyDownHandler);\n      // this.scrollFun = null;\n      window.onmousewheel = document.onmousewheel = null;\n      this.$emit('onClose');\n    },\n    off(element, event, handler) {\n      // console.log(element, event, 'off');\n      if (document.removeEventListener) {\n        if (element && event) {\n          element.removeEventListener(event, handler, false);\n        }\n      } else if (document.detachEvent) {\n        if (element && event) {\n          element.detachEvent('on' + event, handler);\n        }\n      }\n    },\n    on(element, event, handler) {\n      // console.log(element, event, handler, 'on');\n      // console.log(document.addEventListener, 'on');\n      if (document.addEventListener) {// firefox\n        // console.log('111');\n        if (element && event && handler) {\n          element.addEventListener(event, handler, false);\n        }\n      } else if (document.attachEvent) {\n        // console.log('222');\n        if (element && event && handler) {\n          element.attachEvent('on' + event, handler);\n        }\n      }\n    }\n  },\n  destroyed() {\n    // if appendToBody is true, remove DOM node after destroy\n    if (this.appendToBody && this.$el && this.$el.parentNode) {\n      this.$el.parentNode.removeChild(this.$el);\n    }\n  }\n};\n</script>\n\n<style scoped lang=\"less\">\n</style>\n"]}]}