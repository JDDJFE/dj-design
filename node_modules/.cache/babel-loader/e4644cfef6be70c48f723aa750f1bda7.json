{"remainingRequest":"/Users/wangjunxia/work-github/dj-design/node_modules/babel-loader/lib/index.js!/Users/wangjunxia/work-github/dj-design/node_modules/eslint-loader/index.js??ref--14-0!/Users/wangjunxia/work-github/dj-design/packages/table/src/mixins/tree.js","dependencies":[{"path":"/Users/wangjunxia/work-github/dj-design/packages/table/src/mixins/tree.js","mtime":1673509764351},{"path":"/Users/wangjunxia/work-github/dj-design/babel.config.js","mtime":1660011372032},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4ge307CiAgfSwKCiAgbWV0aG9kczogewogICAgb25UcmVlKGl0ZW0sIGluZGV4KSB7CiAgICAgIGlmICghaXRlbSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKGl0ZW0uc2hvd0NoaWxkcmVuKSB7CiAgICAgICAgbGV0IHJlbW92ZUNoaWxkID0gdGhpcy50YWJsZURhdGEuZmlsdGVyKGl0ZW0xID0+IGl0ZW0xLnBhcmVudCA9PSBpdGVtKTsKICAgICAgICByZW1vdmVDaGlsZC5maWx0ZXIoaXRlbTEgPT4gaXRlbTEuc2hvd0NoaWxkcmVuKS5mb3JFYWNoKGl0ZW0xID0+IHsKICAgICAgICAgIHRoaXMub25UcmVlKGl0ZW0xKTsKICAgICAgICB9KTsKICAgICAgICB0aGlzLiRyZW1vdmUodGhpcy50YWJsZURhdGEsIHJlbW92ZUNoaWxkKTsKICAgICAgICBpdGVtLnNob3dDaGlsZHJlbiA9IGZhbHNlOyAvLyBmaXg6IOaUr+aMgem7mOiupOWxleW8gOaJgOacieWtkOe6pwoKICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6ZXhwYW5kVHJlZUFsbCcsIGZhbHNlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpdGVtLnNob3dDaGlsZHJlbiA9IHRydWU7CgogICAgICAgIGlmIChpdGVtLnJvd1t0aGlzLnRyZWUuY2hpbGRyZW5dICYmIGl0ZW0ucm93W3RoaXMudHJlZS5jaGlsZHJlbl0ubGVuZ3RoKSB7CiAgICAgICAgICBpdGVtLnJvd1t0aGlzLnRyZWUuY2hpbGRyZW5dLmZvckVhY2goKGNoaWxkcmVuLCBpKSA9PiB7CiAgICAgICAgICAgIHRoaXMudGFibGVEYXRhLnNwbGljZShpbmRleCArIGkgKyAxLCAwLCB7CiAgICAgICAgICAgICAgcm93OiBjaGlsZHJlbiwKICAgICAgICAgICAgICBwYXJlbnQ6IGl0ZW0sCiAgICAgICAgICAgICAgbGV2ZWw6IGl0ZW0ubGV2ZWwgKyAxLAogICAgICAgICAgICAgIHNob3dDaGlsZHJlbjogZmFsc2UsCiAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaXRlbS5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgIHRoaXMudHJlZS5sb2FkICYmIHRoaXMudHJlZS5sb2FkKGl0ZW0ucm93LCBjaGlsZHJlbnMgPT4gewogICAgICAgICAgICBpdGVtLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgaXRlbS5yb3dbdGhpcy50cmVlLmNoaWxkcmVuXSA9IGNoaWxkcmVuczsKICAgICAgICAgICAgY2hpbGRyZW5zLmZvckVhY2goKGNoaWxkcmVuLCBpKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy50YWJsZURhdGEuc3BsaWNlKGluZGV4ICsgaSArIDEsIDAsIHsKICAgICAgICAgICAgICAgIHJvdzogY2hpbGRyZW4sCiAgICAgICAgICAgICAgICBwYXJlbnQ6IGl0ZW0sCiAgICAgICAgICAgICAgICBsZXZlbDogaXRlbS5sZXZlbCArIDEsCiAgICAgICAgICAgICAgICBzaG93Q2hpbGRyZW46IGZhbHNlLAogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgcmVmcmVzaFRyZWUoKSB7CiAgICAgIGxldCBfdGhpcyA9IHRoaXM7CgogICAgICBsZXQgb2xkRGF0YSA9IHRoaXMuJGNvcHkodGhpcy50YWJsZURhdGEpOwogICAgICBsZXQgbmV3RGF0YSA9IG9sZERhdGEuZmlsdGVyKGl0ZW0gPT4gaXRlbSAmJiBpdGVtLmxldmVsID09IDApOwogICAgICBsZXQgb2xkQ291bnQgPSBuZXdEYXRhLmxlbmd0aCwKICAgICAgICAgIGNvdW50ID0gMDsKCiAgICAgIGxldCBkYXRhRWFjaCA9IChkYXRhLCBsZXZlbCkgPT4gewogICAgICAgIGNvbnN0IGZpbHRlclJlcyA9IGRhdGEuZmlsdGVyKG9JdGVtID0+IHsKICAgICAgICAgIGxldCB0ZW1wID0gb2xkRGF0YS5maW5kKGl0ZW0gPT4gSlNPTi5zdHJpbmdpZnkoaXRlbS5yb3cpID09IEpTT04uc3RyaW5naWZ5KGxldmVsID09IDAgPyBvSXRlbS5yb3cgOiBvSXRlbSkpOwogICAgICAgICAgcmV0dXJuIHRlbXAgPyB0ZW1wLnNob3dDaGlsZHJlbiA6IGZhbHNlOwogICAgICAgIH0pOyAvLyBjb25zb2xlLmxvZyhmaWx0ZXJSZXMsICdmaWx0ZXJSZXMnKTsKCiAgICAgICAgZmlsdGVyUmVzLmZvckVhY2goKG9JdGVtLCBpbmRleCkgPT4gewogICAgICAgICAgb0l0ZW0uc2hvd0NoaWxkcmVuID0gdHJ1ZTsKCiAgICAgICAgICBsZXQgdHJlZUV4cGFuZCA9IChpdGVtLCBpbmRleCkgPT4gewogICAgICAgICAgICB2YXIgX3RoaXMkdHJlZSRjaGlsZHJlbjsKCiAgICAgICAgICAgIChfdGhpcyR0cmVlJGNoaWxkcmVuID0gKGxldmVsID09IDAgPyBpdGVtLnJvdyA6IGl0ZW0pW190aGlzLnRyZWUuY2hpbGRyZW5dKSA9PT0gbnVsbCB8fCBfdGhpcyR0cmVlJGNoaWxkcmVuID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyR0cmVlJGNoaWxkcmVuLmZvckVhY2goKGNoaWxkLCBpKSA9PiB7CiAgICAgICAgICAgICAgbGV0IHRlbXAgPSBvbGREYXRhLmZpbmQoaXRlbSA9PiBKU09OLnN0cmluZ2lmeShpdGVtLnJvdykgPT0gSlNPTi5zdHJpbmdpZnkoY2hpbGQpKTsKICAgICAgICAgICAgICBsZXQgcGFyZW50ID0gbGV2ZWwgPT0gMCA/IGl0ZW0gOiBuZXdEYXRhLmZpbmQocGl0ZW0gPT4gSlNPTi5zdHJpbmdpZnkocGl0ZW0ucm93KSA9PSBKU09OLnN0cmluZ2lmeShpdGVtKSk7CiAgICAgICAgICAgICAgbGV0IHBhcmVudEluZGV4ID0gbmV3RGF0YS5maW5kSW5kZXgocGl0ZW0gPT4gSlNPTi5zdHJpbmdpZnkocGl0ZW0ucm93KSA9PSBKU09OLnN0cmluZ2lmeShwYXJlbnQucm93KSk7CiAgICAgICAgICAgICAgbmV3RGF0YS5zcGxpY2UocGFyZW50SW5kZXggKyBpICsgMSwgMCwgewogICAgICAgICAgICAgICAgcm93OiBjaGlsZCwKICAgICAgICAgICAgICAgIHBhcmVudDogcGFyZW50LAogICAgICAgICAgICAgICAgbGV2ZWw6IGxldmVsICsgMSwKICAgICAgICAgICAgICAgIHNob3dDaGlsZHJlbjogdGVtcCA/IHRlbXAuc2hvd0NoaWxkcmVuIDogZmFsc2UsCiAgICAgICAgICAgICAgICBsb2FkaW5nOiBmYWxzZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH07CgogICAgICAgICAgdHJlZUV4cGFuZChvSXRlbSwgaW5kZXgsIG5ld0RhdGEpOwogICAgICAgICAgbGV0IG5jaGlsZHJlbiA9IGxldmVsID09IDAgPyBvSXRlbS5yb3dbX3RoaXMudHJlZS5jaGlsZHJlbl0gfHwgW10gOiBvSXRlbVtfdGhpcy50cmVlLmNoaWxkcmVuXSB8fCBbXTsKICAgICAgICAgIGNvdW50ICs9IG5jaGlsZHJlbi5sZW5ndGg7CiAgICAgICAgICBkYXRhRWFjaChuY2hpbGRyZW4sIGxldmVsICsgMSk7CiAgICAgICAgfSk7CiAgICAgIH07CgogICAgICBkYXRhRWFjaChuZXdEYXRhLCAwKTsKCiAgICAgIGlmIChvbGREYXRhLmxlbmd0aCAhPSBvbGRDb3VudCArIGNvdW50KSB7CiAgICAgICAgX3RoaXMudGFibGVEYXRhID0gbmV3RGF0YTsKICAgICAgfQogICAgfQoKICB9Cn07"},{"version":3,"names":["data","methods","onTree","item","index","showChildren","removeChild","tableData","filter","item1","parent","forEach","$remove","$emit","row","tree","children","length","i","splice","level","loading","load","childrens","refreshTree","_this","oldData","$copy","newData","oldCount","count","dataEach","filterRes","oItem","temp","find","JSON","stringify","treeExpand","child","pitem","parentIndex","findIndex","nchildren"],"sources":["/Users/wangjunxia/work-github/dj-design/packages/table/src/mixins/tree.js"],"sourcesContent":["export default {\n  data() {\n    return {\n    };\n  },\n  methods: {\n    onTree(item, index) {\n      if (!item) {\n        return false;\n      }\n      if (item.showChildren) {\n        let removeChild = this.tableData.filter(item1 => item1.parent == item);\n        removeChild.filter(item1 => item1.showChildren).forEach(item1 => {\n          this.onTree(item1);\n        });\n        this.$remove(this.tableData, removeChild);\n        item.showChildren = false;\n        // fix: 支持默认展开所有子级\n        this.$emit('update:expandTreeAll', false);\n      } else {\n        item.showChildren = true;\n        if (item.row[this.tree.children] && item.row[this.tree.children].length) {\n          item.row[this.tree.children].forEach((children, i) => {\n            this.tableData.splice(index + i + 1, 0, { row: children, parent: item, level: item.level + 1, showChildren: false, loading: false });\n          });\n        } else {\n          item.loading = true;\n          this.tree.load && this.tree.load(item.row, (childrens) => {\n            item.loading = false;\n            item.row[this.tree.children] = childrens;\n            childrens.forEach((children, i) => {\n              this.tableData.splice(index + i + 1, 0, { row: children, parent: item, level: item.level + 1, showChildren: false, loading: false });\n            });\n          });\n        }\n      }\n    },\n    refreshTree() {\n      let _this = this;\n      let oldData = this.$copy(this.tableData);\n      let newData = oldData.filter(item => item && item.level == 0);\n      let oldCount = newData.length, count = 0;\n      let dataEach = (data, level) => {\n        const filterRes = data.filter(oItem => {\n          let temp = oldData.find(item => JSON.stringify(item.row) == JSON.stringify(level == 0 ? oItem.row : oItem));\n          return temp ? temp.showChildren : false;\n        });\n        // console.log(filterRes, 'filterRes');\n        filterRes.forEach((oItem, index) => {\n          oItem.showChildren = true;\n          let treeExpand = (item, index) => {\n            (level == 0 ? item.row : item)[_this.tree.children]?.forEach((child, i) => {\n              let temp = oldData.find(item => JSON.stringify(item.row) == JSON.stringify(child));\n              let parent = level == 0 ? item : newData.find(pitem => JSON.stringify(pitem.row) == JSON.stringify(item));\n              let parentIndex = newData.findIndex(pitem => JSON.stringify(pitem.row) == JSON.stringify(parent.row));\n              newData.splice(parentIndex + i + 1, 0, { row: child, parent: parent, level: level + 1, showChildren: temp ? temp.showChildren : false, loading: false });\n            });\n          };\n          treeExpand(oItem, index, newData);\n          let nchildren = level == 0 ? oItem.row[_this.tree.children] || [] : oItem[_this.tree.children] || [];\n          count += nchildren.length;\n          dataEach(nchildren, level + 1);\n        });\n      };\n      dataEach(newData, 0);\n      if (oldData.length != oldCount + count) {\n        _this.tableData = newData;\n      }\n    }\n  }\n};\n"],"mappings":"AAAA,eAAe;EACbA,IAAI,GAAG;IACL,OAAO,EAAP;EAED,CAJY;;EAKbC,OAAO,EAAE;IACPC,MAAM,CAACC,IAAD,EAAOC,KAAP,EAAc;MAClB,IAAI,CAACD,IAAL,EAAW;QACT,OAAO,KAAP;MACD;;MACD,IAAIA,IAAI,CAACE,YAAT,EAAuB;QACrB,IAAIC,WAAW,GAAG,KAAKC,SAAL,CAAeC,MAAf,CAAsBC,KAAK,IAAIA,KAAK,CAACC,MAAN,IAAgBP,IAA/C,CAAlB;QACAG,WAAW,CAACE,MAAZ,CAAmBC,KAAK,IAAIA,KAAK,CAACJ,YAAlC,EAAgDM,OAAhD,CAAwDF,KAAK,IAAI;UAC/D,KAAKP,MAAL,CAAYO,KAAZ;QACD,CAFD;QAGA,KAAKG,OAAL,CAAa,KAAKL,SAAlB,EAA6BD,WAA7B;QACAH,IAAI,CAACE,YAAL,GAAoB,KAApB,CANqB,CAOrB;;QACA,KAAKQ,KAAL,CAAW,sBAAX,EAAmC,KAAnC;MACD,CATD,MASO;QACLV,IAAI,CAACE,YAAL,GAAoB,IAApB;;QACA,IAAIF,IAAI,CAACW,GAAL,CAAS,KAAKC,IAAL,CAAUC,QAAnB,KAAgCb,IAAI,CAACW,GAAL,CAAS,KAAKC,IAAL,CAAUC,QAAnB,EAA6BC,MAAjE,EAAyE;UACvEd,IAAI,CAACW,GAAL,CAAS,KAAKC,IAAL,CAAUC,QAAnB,EAA6BL,OAA7B,CAAqC,CAACK,QAAD,EAAWE,CAAX,KAAiB;YACpD,KAAKX,SAAL,CAAeY,MAAf,CAAsBf,KAAK,GAAGc,CAAR,GAAY,CAAlC,EAAqC,CAArC,EAAwC;cAAEJ,GAAG,EAAEE,QAAP;cAAiBN,MAAM,EAAEP,IAAzB;cAA+BiB,KAAK,EAAEjB,IAAI,CAACiB,KAAL,GAAa,CAAnD;cAAsDf,YAAY,EAAE,KAApE;cAA2EgB,OAAO,EAAE;YAApF,CAAxC;UACD,CAFD;QAGD,CAJD,MAIO;UACLlB,IAAI,CAACkB,OAAL,GAAe,IAAf;UACA,KAAKN,IAAL,CAAUO,IAAV,IAAkB,KAAKP,IAAL,CAAUO,IAAV,CAAenB,IAAI,CAACW,GAApB,EAA0BS,SAAD,IAAe;YACxDpB,IAAI,CAACkB,OAAL,GAAe,KAAf;YACAlB,IAAI,CAACW,GAAL,CAAS,KAAKC,IAAL,CAAUC,QAAnB,IAA+BO,SAA/B;YACAA,SAAS,CAACZ,OAAV,CAAkB,CAACK,QAAD,EAAWE,CAAX,KAAiB;cACjC,KAAKX,SAAL,CAAeY,MAAf,CAAsBf,KAAK,GAAGc,CAAR,GAAY,CAAlC,EAAqC,CAArC,EAAwC;gBAAEJ,GAAG,EAAEE,QAAP;gBAAiBN,MAAM,EAAEP,IAAzB;gBAA+BiB,KAAK,EAAEjB,IAAI,CAACiB,KAAL,GAAa,CAAnD;gBAAsDf,YAAY,EAAE,KAApE;gBAA2EgB,OAAO,EAAE;cAApF,CAAxC;YACD,CAFD;UAGD,CANiB,CAAlB;QAOD;MACF;IACF,CA/BM;;IAgCPG,WAAW,GAAG;MACZ,IAAIC,KAAK,GAAG,IAAZ;;MACA,IAAIC,OAAO,GAAG,KAAKC,KAAL,CAAW,KAAKpB,SAAhB,CAAd;MACA,IAAIqB,OAAO,GAAGF,OAAO,CAAClB,MAAR,CAAeL,IAAI,IAAIA,IAAI,IAAIA,IAAI,CAACiB,KAAL,IAAc,CAA7C,CAAd;MACA,IAAIS,QAAQ,GAAGD,OAAO,CAACX,MAAvB;MAAA,IAA+Ba,KAAK,GAAG,CAAvC;;MACA,IAAIC,QAAQ,GAAG,CAAC/B,IAAD,EAAOoB,KAAP,KAAiB;QAC9B,MAAMY,SAAS,GAAGhC,IAAI,CAACQ,MAAL,CAAYyB,KAAK,IAAI;UACrC,IAAIC,IAAI,GAAGR,OAAO,CAACS,IAAR,CAAahC,IAAI,IAAIiC,IAAI,CAACC,SAAL,CAAelC,IAAI,CAACW,GAApB,KAA4BsB,IAAI,CAACC,SAAL,CAAejB,KAAK,IAAI,CAAT,GAAaa,KAAK,CAACnB,GAAnB,GAAyBmB,KAAxC,CAAjD,CAAX;UACA,OAAOC,IAAI,GAAGA,IAAI,CAAC7B,YAAR,GAAuB,KAAlC;QACD,CAHiB,CAAlB,CAD8B,CAK9B;;QACA2B,SAAS,CAACrB,OAAV,CAAkB,CAACsB,KAAD,EAAQ7B,KAAR,KAAkB;UAClC6B,KAAK,CAAC5B,YAAN,GAAqB,IAArB;;UACA,IAAIiC,UAAU,GAAG,CAACnC,IAAD,EAAOC,KAAP,KAAiB;YAAA;;YAChC,wBAACgB,KAAK,IAAI,CAAT,GAAajB,IAAI,CAACW,GAAlB,GAAwBX,IAAzB,EAA+BsB,KAAK,CAACV,IAAN,CAAWC,QAA1C,6EAAqDL,OAArD,CAA6D,CAAC4B,KAAD,EAAQrB,CAAR,KAAc;cACzE,IAAIgB,IAAI,GAAGR,OAAO,CAACS,IAAR,CAAahC,IAAI,IAAIiC,IAAI,CAACC,SAAL,CAAelC,IAAI,CAACW,GAApB,KAA4BsB,IAAI,CAACC,SAAL,CAAeE,KAAf,CAAjD,CAAX;cACA,IAAI7B,MAAM,GAAGU,KAAK,IAAI,CAAT,GAAajB,IAAb,GAAoByB,OAAO,CAACO,IAAR,CAAaK,KAAK,IAAIJ,IAAI,CAACC,SAAL,CAAeG,KAAK,CAAC1B,GAArB,KAA6BsB,IAAI,CAACC,SAAL,CAAelC,IAAf,CAAnD,CAAjC;cACA,IAAIsC,WAAW,GAAGb,OAAO,CAACc,SAAR,CAAkBF,KAAK,IAAIJ,IAAI,CAACC,SAAL,CAAeG,KAAK,CAAC1B,GAArB,KAA6BsB,IAAI,CAACC,SAAL,CAAe3B,MAAM,CAACI,GAAtB,CAAxD,CAAlB;cACAc,OAAO,CAACT,MAAR,CAAesB,WAAW,GAAGvB,CAAd,GAAkB,CAAjC,EAAoC,CAApC,EAAuC;gBAAEJ,GAAG,EAAEyB,KAAP;gBAAc7B,MAAM,EAAEA,MAAtB;gBAA8BU,KAAK,EAAEA,KAAK,GAAG,CAA7C;gBAAgDf,YAAY,EAAE6B,IAAI,GAAGA,IAAI,CAAC7B,YAAR,GAAuB,KAAzF;gBAAgGgB,OAAO,EAAE;cAAzG,CAAvC;YACD,CALD;UAMD,CAPD;;UAQAiB,UAAU,CAACL,KAAD,EAAQ7B,KAAR,EAAewB,OAAf,CAAV;UACA,IAAIe,SAAS,GAAGvB,KAAK,IAAI,CAAT,GAAaa,KAAK,CAACnB,GAAN,CAAUW,KAAK,CAACV,IAAN,CAAWC,QAArB,KAAkC,EAA/C,GAAoDiB,KAAK,CAACR,KAAK,CAACV,IAAN,CAAWC,QAAZ,CAAL,IAA8B,EAAlG;UACAc,KAAK,IAAIa,SAAS,CAAC1B,MAAnB;UACAc,QAAQ,CAACY,SAAD,EAAYvB,KAAK,GAAG,CAApB,CAAR;QACD,CAdD;MAeD,CArBD;;MAsBAW,QAAQ,CAACH,OAAD,EAAU,CAAV,CAAR;;MACA,IAAIF,OAAO,CAACT,MAAR,IAAkBY,QAAQ,GAAGC,KAAjC,EAAwC;QACtCL,KAAK,CAAClB,SAAN,GAAkBqB,OAAlB;MACD;IACF;;EA/DM;AALI,CAAf"}]}