{"remainingRequest":"/Users/wangjunxia/work-github/dj-design/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangjunxia/work-github/dj-design/src/views/code/code.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangjunxia/work-github/dj-design/src/views/code/code.vue","mtime":1673509764392},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBWdWUgZnJvbSAndnVlJzsKLy8gaW1wb3J0IGNvZGVtaXJyb3IgZnJvbSAnLi9jb2RlbWlycm9yJzsKLy8gaW1wb3J0IHRvSFRNTCBmcm9tICd2ZG9tLXRvLWh0bWwnOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdkakNvZGUnLAogIC8vIGNvbXBvbmVudHM6IHtjb2RlbWlycm9yfSwKICBwcm9wczogewogICAgdHlwZTogU3RyaW5nLAogICAgaW5mbzogT2JqZWN0LAogICAgdmFsdWU6IFN0cmluZywKICAgIHRpdGxlOiBTdHJpbmcsCiAgICBjb2RlU2hvdzogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9LAogICAgZGF0YTogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6ICgpID0+IHsKICAgICAgICByZXR1cm4ge307CiAgICAgIH0KICAgIH0sCiAgICBvcHRpb25zOiBPYmplY3QsCiAgICBpbmRleDogTnVtYmVyCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY29kZTogdGhpcy5zZXRDb2RlKCksCiAgICAgIHNob3dDb2RlOiBmYWxzZQogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICB2YWx1ZTogZnVuY3Rpb24obywgbikgewogICAgICAvLyB0aGlzLmNvZGUgPSB0aGlzLnZhbHVlLnJlcGxhY2UoLyB7NH0vZywgJycpOwogICAgICAvLyB0aGlzLmNvZGUgPSB0aGlzLmh0bWxGb3JtYXQodGhpcy52YWx1ZSk7CiAgICAgIHRoaXMuc2V0Q29kZSgpOwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuaW5zZXJ0KCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBzZXRDb2RlKCkgewogICAgICBsZXQgc2NvcGUxID0gJzxzY3JpcHQ+JzsKICAgICAgLy8gPC8gc2NyaXB0Pui/meagt+WGmeaYr+S4uuino+WGs2VzbGludCDmiqXplJkKICAgICAgbGV0IHNjb3BlMiA9ICc8LyBzY3JpcHQ+Jy5yZXBsYWNlKCcgJywgJycpOwogICAgICBpZiAodGhpcy5kYXRhLmRhdGEgfHwgdGhpcy5kYXRhLm1ldGhvZHMpIHsKICAgICAgICB0aGlzLmNvZGUgPSBgJHt0aGlzLnZhbHVlfQogICAgICAgICAgJHtzY29wZTF9CiAgICAgICAgICBleHBvcnQgZGVmYXVsdCAke3RoaXMub2JqVG9TdHJpbmcodGhpcy5kYXRhKX0KICAgICAgICAgICR7c2NvcGUyfWA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jb2RlID0gYCR7dGhpcy52YWx1ZX0KICAgICAgICAgICR7c2NvcGUxfQogICAgICAgICAgZXhwb3J0IGRlZmF1bHQgewogICAgICAgICAgICBkYXRhKCkgewogICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbWV0aG9kczogewogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICAke3Njb3BlMn1gOwogICAgICB9CiAgICAgIHRoaXMuY29kZSA9IHRoaXMuaHRtbEZvcm1hdCh0aGlzLmNvZGUpOwogICAgICByZXR1cm4gdGhpcy5jb2RlOwogICAgfSwKICAgIGluc2VydCgpIHsKICAgICAgaWYgKCF0aGlzLmNvZGUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbGV0IHRlbXAgPSB0aGlzLmNvZGUuc3BsaXQoJzxzY3JpcHQ+Jyk7CiAgICAgIGxldCBjb2RlID0gdGVtcFswXS5yZXBsYWNlKC9cbi9nLCAnJykucmVwbGFjZSgvPiggezEsfSk8L2csICc+PCcpOwogICAgICBsZXQgZGF0YSA9IHt9OwogICAgICBsZXQgc2NyaXB0ID0gdGVtcFsxXTsKICAgICAgaWYgKHNjcmlwdCAmJiBzY3JpcHQuaW5kZXhPZignZXhwb3J0IGRlZmF1bHQgJykgPiAtMSkgewogICAgICAgIHNjcmlwdCA9IHNjcmlwdC5zdWJzdHJpbmcoc2NyaXB0LmluZGV4T2YoJ3snKSwgc2NyaXB0Lmxlbmd0aCk7CiAgICAgICAgc2NyaXB0ID0gc2NyaXB0LnJlcGxhY2UoJ2V4cG9ydCBkZWZhdWx0ICcsICcnKS5yZXBsYWNlKCc8LyBzY3JpcHQ+Jy5yZXBsYWNlKCcgJywgJycpLCAnJyk7CiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLW5ldy1mdW5jCiAgICAgICAgZGF0YSA9IG5ldyBGdW5jdGlvbihgcmV0dXJuICR7c2NyaXB0fWApKCk7CiAgICAgIH0KICAgICAgVnVlLmNvbXBvbmVudChgYmxvY2stY29kZSR7dGhpcy5pbmRleH1gLCB7CiAgICAgICAgdGVtcGxhdGU6IGA8ZGl2IGlkPSJibG9jay1jb2RlJHt0aGlzLmluZGV4fSIgY2xhc3M9ImNhc2UtY29kZSI+YCArIGNvZGUgKyAnPC9kaXY+JywKICAgICAgICAuLi5kYXRhCiAgICAgIH0pOwogICAgICBjb25zdCBCbG9ja0NvZGUgPSBWdWUuY29tcG9uZW50KGBibG9jay1jb2RlJHt0aGlzLmluZGV4fWApOyAvLyDlj6rog73mn6Xmib7liLDlhajlsYDms6jlhozliLDnu4Tku7YKICAgICAgY29uc3QgaW5zdGFuY2UgPSBuZXcgQmxvY2tDb2RlKCk7CiAgICAgIGluc3RhbmNlLiRtb3VudChgI2Jsb2NrLWNvZGUke3RoaXMuaW5kZXh9YCk7CiAgICB9LAogICAgb2JqVG9TdHJpbmcoZGF0YSkgewogICAgICByZXR1cm4gYHsKICAgICAgICBgICsgT2JqZWN0LmtleXMoZGF0YSkubWFwKGtleSA9PiB7CiAgICAgICAgaWYgKHR5cGVvZiBkYXRhW2tleV0gPT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgcmV0dXJuIGRhdGFba2V5XS50b1N0cmluZygpLnJlcGxhY2UoJ2Z1bmN0aW9uICcsICcnKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGtleSArICc6ICcgKyB0aGlzLm9ialRvU3RyaW5nKGRhdGFba2V5XSk7CiAgICAgIH0pLmpvaW4oJyxcbicpICsgYAogICAgICB9YDsKICAgIH0sCiAgICBodG1sRm9ybWF0KGh0bWwpIHsgLy8g5qC85byP5YyWaHRtbOS7o+eggQogICAgICAvLyBodG1sLnJlcGxhY2UoL30vZywgJ31cbicpOwogICAgICBpZiAoIWh0bWwpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbGV0IGxpc3QgPSBodG1sLnNwbGl0KCdcbicpOwogICAgICBsZXQgY291bnQgPSAwOwogICAgICBsaXN0ID0gbGlzdC5tYXAocm93ID0+IHsKICAgICAgICBpZiAoIXJvdykgewogICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0KICAgICAgICBsZXQgc3RyID0gdGhpcy50cmltKHJvdyk7CiAgICAgICAgc3RyID0gdGhpcy50YWJTaXplKHN0ciwgY291bnQpOwogICAgICAgIGlmIChzdHIuaW5kZXhPZignPCcpID4gLTEgJiYgc3RyLmluZGV4T2YoJzwnKSAhPSBzdHIuaW5kZXhPZignPC8nKSB8fCBzdHIuaW5kZXhPZigneycpID4gLTEpIHsKICAgICAgICAgIGNvdW50Kys7CiAgICAgICAgfQogICAgICAgIGlmIChzdHIuaW5kZXhPZignPC8nKSA+IC0xIHx8IHN0ci5pbmRleE9mKCcvPicpID4gLTEgfHwgc3RyLmluZGV4T2YoJ30nKSA+IC0xKSB7CiAgICAgICAgICBjb3VudC0tOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc3RyOwogICAgICB9KTsKICAgICAgcmV0dXJuIGxpc3Quam9pbignXG4nKTsKICAgIH0sCiAgICB0cmltKHN0cikgeyAvLyDljrvlpLTlsL7nqbrmoLwKICAgICAgcmV0dXJuIHRoaXMudHJpbUxlZnQodGhpcy50cmltUmlnaHQoc3RyKSk7CiAgICB9LAogICAgdHJpbUxlZnQoc3RyKSB7IC8vIOWOu+WktOmDqOepuuagvAogICAgICBpZiAoIXN0cikgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQogICAgICBpZiAoc3RyLmluZGV4T2YoJyAnKSA9PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudHJpbUxlZnQoc3RyLnN1YnN0cmluZygxLCBzdHIubGVuZ3RoKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH0sCiAgICB0cmltUmlnaHQoc3RyKSB7IC8vIOWOu+acq+WwvuepuuagvAogICAgICBpZiAoIXN0cikgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQogICAgICBpZiAoc3RyLmxhc3RJbmRleE9mKCcgJykgPT0gc3RyLmxlbmd0aCAtIDEpIHsKICAgICAgICByZXR1cm4gdGhpcy50cmltUmlnaHQoc3RyLnN1YnN0cmluZygwLCBzdHIubGVuZ3RoIC0gMSkpOwogICAgICB9CiAgICAgIHJldHVybiBzdHI7CiAgICB9LAogICAgdGFiU2l6ZShzdHIsIHNpemUpIHsgLy8g5aKe5Yqg6YCA5qC856ymCiAgICAgIGxldCBjb3VudCA9IHNpemU7CiAgICAgIGlmIChzdHIuaW5kZXhPZignPC8nKSA9PSAwIHx8IHN0ci5pbmRleE9mKCcvPicpID09IDAgfHwgc3RyLmluZGV4T2YoJ30nKSA9PSAwKSB7CiAgICAgICAgY291bnQtLTsKICAgICAgfQogICAgICBpZiAoY291bnQgPD0gMCkgewogICAgICAgIHJldHVybiBzdHI7CiAgICAgIH0KICAgICAgbGV0IHRhYlN0ciA9ICcnOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICB0YWJTdHIgKz0gJyAgJzsKICAgICAgfQogICAgICByZXR1cm4gdGFiU3RyICsgc3RyOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["code.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"code.vue","sourceRoot":"src/views/code","sourcesContent":["<template>\n  <div class=\"dj-code\">\n    <h2 v-if=\"type == 'example'\">{{title}}</h2>\n    <div class=\"temp-test\" v-if=\"type == 'test' && info\">\n      <p><span>bug描述：</span>{{info.scene}}</p>\n      <p><span>更改时间：</span>{{info.repairtime}}</p>\n    </div>\n    <div :id=\"`block-code${index}`\" class=\"case-code\"></div>\n    <div class=\"temp-code\" v-if=\"codeShow\">\n      <dj-button v-show=\"!showCode\" icon=\"turning-bottom\" type=\"text\" style=\"width: 100%; padding: 10px;\" @click=\"showCode = true\"></dj-button>\n      <transition name=\"fade\">\n<!--        <codemirror v-if=\"showCode\" v-model=\"code\" :options=\"options\"></codemirror>-->\n        <dj-json v-if=\"showCode\" v-model=\"code\" theme=\"base16-dark\" language=\"vue\"/>\n      </transition>\n      <div v-show=\"showCode\" class=\"up\">\n        <dj-button icon=\"turning-top\" type=\"text\" style=\"width: 100%; padding: 10px;\" @click=\"showCode = false\"></dj-button>\n        <dj-button type=\"text\" icon=\"turning-right\" style=\"position: absolute; right: 0; padding: 10px;\" @click=\"insert()\">运行</dj-button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Vue from 'vue';\n// import codemirror from './codemirror';\n// import toHTML from 'vdom-to-html';\n\nexport default {\n  name: 'djCode',\n  // components: {codemirror},\n  props: {\n    type: String,\n    info: Object,\n    value: String,\n    title: String,\n    codeShow: {\n      type: Boolean,\n      default: true\n    },\n    data: {\n      type: Object,\n      default: () => {\n        return {};\n      }\n    },\n    options: Object,\n    index: Number\n  },\n  data() {\n    return {\n      code: this.setCode(),\n      showCode: false\n    };\n  },\n  watch: {\n    value: function(o, n) {\n      // this.code = this.value.replace(/ {4}/g, '');\n      // this.code = this.htmlFormat(this.value);\n      this.setCode();\n    }\n  },\n  mounted() {\n    this.insert();\n  },\n  methods: {\n    setCode() {\n      let scope1 = '<script>';\n      // </ script>这样写是为解决eslint 报错\n      let scope2 = '</ script>'.replace(' ', '');\n      if (this.data.data || this.data.methods) {\n        this.code = `${this.value}\n          ${scope1}\n          export default ${this.objToString(this.data)}\n          ${scope2}`;\n      } else {\n        this.code = `${this.value}\n          ${scope1}\n          export default {\n            data() {\n              return {\n              };\n            },\n            methods: {\n            }\n          }\n          ${scope2}`;\n      }\n      this.code = this.htmlFormat(this.code);\n      return this.code;\n    },\n    insert() {\n      if (!this.code) {\n        return;\n      }\n      let temp = this.code.split('<script>');\n      let code = temp[0].replace(/\\n/g, '').replace(/>( {1,})</g, '><');\n      let data = {};\n      let script = temp[1];\n      if (script && script.indexOf('export default ') > -1) {\n        script = script.substring(script.indexOf('{'), script.length);\n        script = script.replace('export default ', '').replace('</ script>'.replace(' ', ''), '');\n        // eslint-disable-next-line no-new-func\n        data = new Function(`return ${script}`)();\n      }\n      Vue.component(`block-code${this.index}`, {\n        template: `<div id=\"block-code${this.index}\" class=\"case-code\">` + code + '</div>',\n        ...data\n      });\n      const BlockCode = Vue.component(`block-code${this.index}`); // 只能查找到全局注册到组件\n      const instance = new BlockCode();\n      instance.$mount(`#block-code${this.index}`);\n    },\n    objToString(data) {\n      return `{\n        ` + Object.keys(data).map(key => {\n        if (typeof data[key] == 'function') {\n          return data[key].toString().replace('function ', '');\n        }\n        return key + ': ' + this.objToString(data[key]);\n      }).join(',\\n') + `\n      }`;\n    },\n    htmlFormat(html) { // 格式化html代码\n      // html.replace(/}/g, '}\\n');\n      if (!html) {\n        return;\n      }\n      let list = html.split('\\n');\n      let count = 0;\n      list = list.map(row => {\n        if (!row) {\n          return '';\n        }\n        let str = this.trim(row);\n        str = this.tabSize(str, count);\n        if (str.indexOf('<') > -1 && str.indexOf('<') != str.indexOf('</') || str.indexOf('{') > -1) {\n          count++;\n        }\n        if (str.indexOf('</') > -1 || str.indexOf('/>') > -1 || str.indexOf('}') > -1) {\n          count--;\n        }\n        return str;\n      });\n      return list.join('\\n');\n    },\n    trim(str) { // 去头尾空格\n      return this.trimLeft(this.trimRight(str));\n    },\n    trimLeft(str) { // 去头部空格\n      if (!str) {\n        return '';\n      }\n      if (str.indexOf(' ') == 0) {\n        return this.trimLeft(str.substring(1, str.length));\n      }\n      return str;\n    },\n    trimRight(str) { // 去末尾空格\n      if (!str) {\n        return '';\n      }\n      if (str.lastIndexOf(' ') == str.length - 1) {\n        return this.trimRight(str.substring(0, str.length - 1));\n      }\n      return str;\n    },\n    tabSize(str, size) { // 增加退格符\n      let count = size;\n      if (str.indexOf('</') == 0 || str.indexOf('/>') == 0 || str.indexOf('}') == 0) {\n        count--;\n      }\n      if (count <= 0) {\n        return str;\n      }\n      let tabStr = '';\n      for (let i = 0; i < count; i++) {\n        tabStr += '  ';\n      }\n      return tabStr + str;\n    }\n  }\n};\n</script>\n\n<style lang=\"less\">\n</style>\n"]}]}