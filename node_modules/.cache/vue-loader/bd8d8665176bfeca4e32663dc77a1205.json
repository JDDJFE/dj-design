{"remainingRequest":"/Users/wangjunxia/work-github/dj-design/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangjunxia/work-github/dj-design/packages/image/src/imagePreview.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangjunxia/work-github/dj-design/packages/image/src/imagePreview.vue","mtime":1673509764327},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmxldCBwcmV2T3ZlcmZsb3cgPSAnJzsKbGV0IG1vdXNld2hlZWxFdmVudE5hbWUgPSAnbW91c2V3aGVlbCc7CmlmIChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKSB7Ly8gZmlyZWZveAogIG1vdXNld2hlZWxFdmVudE5hbWUgPSAnRE9NTW91c2VTY3JvbGwnOwp9IGVsc2UgewogIC8vIHdpbmRvdy5vbm1vdXNld2hlZWwgPSBkb2N1bWVudC5vbm1vdXNld2hlZWwgPSB0aGlzLnNjcm9sbEZ1bjsKICBtb3VzZXdoZWVsRXZlbnROYW1lID0gJ29ubW91c2V3aGVlbCc7Cn0KLy8gZnVuY3Rpb24gcmFmVGhyb3R0bGUoZm4pIHsKLy8gICBsZXQgbG9ja2VkID0gZmFsc2U7Ci8vICAgcmV0dXJuIGZ1bmN0aW9uKC4uLmFyZ3MpIHsKLy8gICAgIGlmIChsb2NrZWQpIHJldHVybjsKLy8gICAgIGxvY2tlZCA9IHRydWU7Ci8vICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKF8gPT4gewovLyAgICAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKLy8gICAgICAgbG9ja2VkID0gZmFsc2U7Ci8vICAgICB9KTsKLy8gICB9OwovLyB9CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnZGpJbWFnZVByZXZpZXcnLAogIHByb3BzOiB7CiAgICBwcmV2aWV3U3JjTGlzdDogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdDogKCkgPT4gW10KICAgIH0sCiAgICBpbml0aWFsSW5kZXg6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAwCiAgICB9LAogICAgbWFza0Nsb3NhYmxlOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCiAgICBzaG93Vmlld2VyOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCiAgICAvLyDmmK/lkKbmmL7npLrkuIvovb0KICAgIGRvd25sb2FkU3RhdHVzOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhcHBlbmRUb0JvZHk6IHRydWUsCiAgICAgIGluZGV4OiB0aGlzLmluaXRpYWxJbmRleCwKICAgICAgdHJhbnNmb3JtOiB7CiAgICAgICAgc2NhbGU6IDEsCiAgICAgICAgZGVnOiAwLAogICAgICAgIGVuYWJsZVRyYW5zaXRpb246IGZhbHNlLAogICAgICAgIG9mZnNldFg6IDAsCiAgICAgICAgb2Zmc2V0WTogMAogICAgICB9CiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGN1cnJlbnRJbWcoKSB7CiAgICAgIHJldHVybiB0aGlzLnByZXZpZXdTcmNMaXN0W3RoaXMuaW5kZXhdOwogICAgfSwKICAgIGltZ1N0eWxlKCkgewogICAgICBsZXQgc3R5bGUgPSB7fTsKICAgICAgc3R5bGUubWF4V2lkdGggPSBzdHlsZS5tYXhIZWlnaHQgPSAnMTAwJSc7CiAgICAgIHN0eWxlLnRyYW5zZm9ybSA9IGBzY2FsZSgke3RoaXMudHJhbnNmb3JtLnNjYWxlfSkgcm90YXRlKCR7dGhpcy50cmFuc2Zvcm0uZGVnfWRlZylgOwogICAgICBzdHlsZS50cmFuc2l0aW9uID0gdGhpcy50cmFuc2Zvcm0uZW5hYmxlVHJhbnNpdGlvbiA/ICd0cmFuc2Zvcm0gLjNzJyA6ICcnOwogICAgICBzdHlsZS5tYXJnaW5Ub3AgPSB0aGlzLnRyYW5zZm9ybS5vZmZzZXRZICsgJ3B4JzsKICAgICAgc3R5bGUubWFyZ2luTGVmdCA9IHRoaXMudHJhbnNmb3JtLm9mZnNldFggKyAncHgnOwogICAgICByZXR1cm4gc3R5bGU7CiAgICB9LAogICAgd3JhcHBlclN0eWxlKCkgewogICAgICBsZXQgc3R5bGUgPSB7fTsKICAgICAgLy8gc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZTNkKCR7dGhpcy50cmFuc2Zvcm0ub2Zmc2V0WCAvIDJ9cHgsICR7dGhpcy50cmFuc2Zvcm0ub2Zmc2V0WSAvIDJ9cHgsIDApYDsKICAgICAgcmV0dXJuIHN0eWxlOwogICAgfSwKICAgIHRvb2x0aXBJZCgpIHsKICAgICAgcmV0dXJuIGBkai1pbWctcHJldmlldy0ke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKX1gOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIHNob3dWaWV3ZXI6IHsKICAgICAgaGFuZGxlcigpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnNob3dWaWV3ZXIsICd0aGlzLnNob3dWaWV3ZXInKTsKICAgICAgICBpZiAodGhpcy5zaG93Vmlld2VyKSB7CiAgICAgICAgICB0aGlzLm9uKGRvY3VtZW50LCBtb3VzZXdoZWVsRXZlbnROYW1lLCB0aGlzLnNjcm9sbEZ1bik7CiAgICAgICAgICB0aGlzLm9uKGRvY3VtZW50LCAna2V5ZG93bicsIHRoaXMua2V5RG93bkhhbmRsZXIpOwogICAgICAgICAgLy8gU2FmYXJp5LiOQ2hyb21l5bGe5LqO5ZCM5LiA57G75Z6LCiAgICAgICAgICB3aW5kb3cub25tb3VzZXdoZWVsID0gZG9jdW1lbnQub25tb3VzZXdoZWVsID0gdGhpcy5zY3JvbGxGdW47CiAgICAgICAgICBwcmV2T3ZlcmZsb3cgPSBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93OwogICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gcHJldk92ZXJmbG93OwogICAgICAgIH0KICAgICAgfSwKICAgICAgZGVlcDogdHJ1ZQogICAgfSwKICAgIGluaXRpYWxJbmRleDogewogICAgICBoYW5kbGVyKCkgewogICAgICAgIHRoaXMuaW5kZXggPSB0aGlzLmluaXRpYWxJbmRleDsKICAgICAgfSwKICAgICAgZGVlcDogdHJ1ZQogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIC8vIHRoaXMuZGV2aWNlU3VwcG9ydEluc3RhbGwoKTsKICAgIGlmICh0aGlzLmFwcGVuZFRvQm9keSkgewogICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuJGVsKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGRvd25sb2FkKCkgewogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLiRsaXN0ZW5lcnMsICckbGlzdGVuZXJzJyk7CiAgICAgIGlmICh0aGlzLiRsaXN0ZW5lcnM/LmRvd25sb2FkKSB7Ly8gdGhpcy5jdXN0b21Eb3dubG9hZAogICAgICAgIHRoaXMuJGVtaXQoJ2Rvd25sb2FkJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIC8vIGNvbnNvbGUubG9nKCflrZDnuqflhoXnva7kuIvovb0nKTsKICAgICAgLy8gcmV0dXJuOwogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5yZWFjaGFibGUKICAgICAgdGhpcy5kb3dubG9hZEZ1bigpOwogICAgfSwKICAgIGRvd25sb2FkRnVuKCkgewogICAgICBsZXQgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnRvb2x0aXBJZCk7IC8vIOiOt+WPluimgeS4i+i9veeahOWbvueJhwogICAgICBsZXQgaW1nVXJsID0gaW1hZ2Uuc3JjOyAvLyDojrflj5blm77niYflnLDlnYAKICAgICAgbGV0IGltZ1VybEFyciA9IGltZ1VybD8uc3BsaXQoJy8nKTsKICAgICAgbGV0IGltZ1VybE5hbWUgPSBpbWdVcmxBcnJbaW1nVXJsQXJyPy5sZW5ndGggLSAxXTsKICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogICAgICB4aHIub3BlbignZ2V0JywgaW1nVXJsLCB0cnVlKTsKICAgICAgLy8g6Iez5YWz6YeN6KaBCiAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYmxvYic7CiAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHsKICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICAvLyDlvpfliLDkuIDkuKpibG9i5a+56LGhCiAgICAgICAgICBsZXQgYmxvYiA9IHRoaXMucmVzcG9uc2U7CiAgICAgICAgICAvLyDoh7PlhbPph43opoEKICAgICAgICAgIGxldCBvRmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICBvRmlsZVJlYWRlci5vbmxvYWRlbmQgPSBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIGxldCBiYXNlNjQgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICAgIGxldCBlbGVMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgICAgICBlbGVMaW5rLmRvd25sb2FkID0gaW1nVXJsTmFtZTsKICAgICAgICAgICAgZWxlTGluay5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBlbGVMaW5rLmhyZWYgPSBiYXNlNjQ7CiAgICAgICAgICAgIC8vIOinpuWPkeeCueWHuwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZUxpbmspOwogICAgICAgICAgICBlbGVMaW5rLmNsaWNrKCk7CiAgICAgICAgICAgIC8vIOeEtuWQjuenu+mZpAogICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZUxpbmspOwogICAgICAgICAgfTsKICAgICAgICAgIG9GaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwoYmxvYik7CiAgICAgICAgfQogICAgICB9OwogICAgICB4aHIuc2VuZCgpOwogICAgICAvKiBsZXQgaW1nVXJsU3VmZml4QXJyID0gaW1nVXJsPy5zcGxpdCgnLicpOwogICAgICBsZXQgaW1nVXJsU3VmZml4ID0gaW1nVXJsU3VmZml4QXJyW2ltZ1VybFN1ZmZpeEFycj8ubGVuZ3RoIC0gMV07CiAgICAgIGNvbnNvbGUubG9nKGltZ1VybE5hbWUsJ2ltZ1VybE5hbWUnKTsKICAgICAgaW1hZ2Uuc2V0QXR0cmlidXRlKCdjcm9zc09yaWdpbicsICdhbm9ueW1vdXMnKTsKICAgICAgdGhpcy5mdW5Eb3dubG9hZChpbWFnZSwgaW1nVXJsTmFtZSwgaW1nVXJsU3VmZml4KTsqLwogICAgfSwKICAgIGZ1bkRvd25sb2FkKGRvbUltZywgZmlsZW5hbWUsIHN1ZmZpeCkgewogICAgICBsZXQgYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdteUNhbnZhcycpOwogICAgICBsZXQgY3R4ID0gYy5nZXRDb250ZXh0KCcyZCcpOwogICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICBjdHguZHJhd0ltYWdlKGRvbUltZywgMCwgMCk7CiAgICAgIH0sIDEwKTsKICAgICAgLy8gY29uc29sZS5sb2coZG9tSW1nLCAnZG9tSW1nJyk7CiAgICAgIC8vIOWIm+W7uumakOiXj+eahOWPr+S4i+i9vemTvuaOpQogICAgICB2YXIgZWxlTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgZWxlTGluay5kb3dubG9hZCA9IGZpbGVuYW1lOwogICAgICBlbGVMaW5rLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgIC8vIOWbvueJh+i9rGJhc2U2NOWcsOWdgAogICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7CiAgICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHZhciB3aWR0aCA9IGRvbUltZy5uYXR1cmFsV2lkdGg7CiAgICAgICAgdmFyIGhlaWdodCA9IGRvbUltZy5uYXR1cmFsSGVpZ2h0OwogICAgICAgIGNhbnZhcy53aWR0aCA9IHdpZHRoOwogICAgICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgICAgLy8gY29uc29sZS5sb2coY2FudmFzLCAnY2FudmFzJyk7CiAgICAgICAgLy8gY29uc29sZS5sb2coY29udGV4dCwgJ2NvbnRleHQnKTsKICAgICAgICBjb250ZXh0LmRyYXdJbWFnZShkb21JbWcsIDAsIDApOwogICAgICAgIC8vIOWmguaenOaYr1BOR+WbvueJh++8jOWImWNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlL3BuZycpCiAgICAgICAgLy8gZWxlTGluay5ocmVmID0gY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvJyArIHN1ZmZpeCk7CiAgICAgICAgZWxlTGluay5ocmVmID0gY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvZ2lmJyk7CiAgICAgICAgLy8g6Kem5Y+R54K55Ye7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVMaW5rKTsKICAgICAgICBlbGVMaW5rLmNsaWNrKCk7CiAgICAgICAgLy8g54S25ZCO56e76ZmkCiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbGVMaW5rKTsKICAgICAgfSwgMTApOwogICAgfSwKICAgIC8vIOaMiemUruS6i+S7tgogICAga2V5RG93bkhhbmRsZXIoZSkgewogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICBjb25zdCBrZXlDb2RlID0gZS5rZXlDb2RlOwogICAgICBzd2l0Y2ggKGtleUNvZGUpIHsKICAgICAgICAvLyBFU0MKICAgICAgICBjYXNlIDI3OgogICAgICAgICAgdGhpcy5jbG9zZSgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgLy8g5bem566t5aS0CiAgICAgICAgY2FzZSAzNzoKICAgICAgICAgIHRoaXMucHJldigpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgLy8g5Y+z566t5aS0CiAgICAgICAgY2FzZSAzOToKICAgICAgICAgIHRoaXMubmV4dCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0sCiAgICAvLyDog4zmma/ngrnlh7sKICAgIGhhbmRsZU1hc2tDbGljaygpIHsKICAgICAgLy8gY29uc29sZS5sb2coJ2hhbmRsZU1hc2tDbGljaycpOwogICAgICBpZiAodGhpcy5tYXNrQ2xvc2FibGUpIHsKICAgICAgICB0aGlzLmNsb3NlKCk7CiAgICAgIH0KICAgIH0sCiAgICAvLyDpvKDmoIfmu5rova7mu5rliqgKICAgIHNjcm9sbEZ1bihlKSB7CiAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgLy8gY29uc29sZS5sb2coZSwgJ2VlZWVlZScpOwogICAgICBpZiAoZS53aGVlbERlbHRhKSB7Ly8g5Yik5pat5rWP6KeI5ZmoSUXvvIzosLfmrYzmu5Hova7kuovku7YKICAgICAgICBpZiAoZS53aGVlbERlbHRhID4gMCkgey8vIOW9k+a7kei9ruWQkeS4iua7muWKqOaXtgogICAgICAgICAgLy8gY29uc29sZS5sb2coJ+S4iua7miBJRe+8jOiwt+atjCcpOwogICAgICAgICAgdGhpcy5oYW5kbGVBY3Rpb25zKCd6b29tSW4nLCB7IHpvb21SYXRlOiAwLjAxNSwgZW5hYmxlVHJhbnNpdGlvbjogZmFsc2UgfSk7CiAgICAgICAgfQogICAgICAgIGlmIChlLndoZWVsRGVsdGEgPCAwKSB7Ly8g5b2T5ruR6L2u5ZCR5LiL5rua5Yqo5pe2CiAgICAgICAgICAvLyBjb25zb2xlLmxvZygn5LiL5ruaIElF77yM6LC35q2MJyk7CiAgICAgICAgICB0aGlzLmhhbmRsZUFjdGlvbnMoJ3pvb21PdXQnLCB7IHpvb21SYXRlOiAwLjAxNSwgZW5hYmxlVHJhbnNpdGlvbjogZmFsc2UgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGUuZGV0YWlsKSB7Ly8gRmlyZWZveOa7kei9ruS6i+S7tgogICAgICAgIGlmIChlLmRldGFpbCA+IDApIHsvLyDlvZPmu5Hova7lkJHkuIvmu5rliqjml7YKICAgICAgICAgIHRoaXMuaGFuZGxlQWN0aW9ucygnem9vbU91dCcsIHsgem9vbVJhdGU6IDAuMDE1LCBlbmFibGVUcmFuc2l0aW9uOiBmYWxzZSB9KTsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCfkuIvmu5ogRmlyZWZveCcpOwogICAgICAgIH0KICAgICAgICBpZiAoZS5kZXRhaWwgPCAwKSB7Ly8g5b2T5ruR6L2u5ZCR5LiK5rua5Yqo5pe2CiAgICAgICAgICB0aGlzLmhhbmRsZUFjdGlvbnMoJ3pvb21JbicsIHsgem9vbVJhdGU6IDAuMDE1LCBlbmFibGVUcmFuc2l0aW9uOiBmYWxzZSB9KTsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCfkuIrmu5ogRmlyZWZveCcpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOWKqOS9nAogICAgaGFuZGxlQWN0aW9ucyhhY3Rpb24sIG9wdGlvbnMpIHsKICAgICAgbGV0IHRyYW5zZm9ybSA9IHRoaXMudHJhbnNmb3JtOwogICAgICBsZXQgeyBlbmFibGVUcmFuc2l0aW9uLCB6b29tUmF0ZSwgcm90YXRlRGVnIH0gPSB7CiAgICAgICAgem9vbVJhdGU6IDAuMiwKICAgICAgICByb3RhdGVEZWc6IDkwLAogICAgICAgIGVuYWJsZVRyYW5zaXRpb246IHRydWUsCiAgICAgICAgLi4ub3B0aW9ucwogICAgICB9OwogICAgICBzd2l0Y2ggKGFjdGlvbikgewogICAgICAgIGNhc2UgJ3pvb21PdXQnOgogICAgICAgICAgaWYgKHRyYW5zZm9ybS5zY2FsZSA+IDAuMikgewogICAgICAgICAgICB0cmFuc2Zvcm0uc2NhbGUgPSBwYXJzZUZsb2F0KCh0cmFuc2Zvcm0uc2NhbGUgLSB6b29tUmF0ZSkudG9GaXhlZCgzKSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICd6b29tSW4nOgogICAgICAgICAgdHJhbnNmb3JtLnNjYWxlID0gcGFyc2VGbG9hdCgodHJhbnNmb3JtLnNjYWxlICsgem9vbVJhdGUpLnRvRml4ZWQoMykpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAncm90YXRlUmlnaHQnOgogICAgICAgICAgdHJhbnNmb3JtLmRlZyArPSByb3RhdGVEZWc7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdyb3RhdGVMZWZ0JzoKICAgICAgICAgIHRyYW5zZm9ybS5kZWcgLT0gcm90YXRlRGVnOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgdGhpcy50cmFuc2Zvcm0uZW5hYmxlVHJhbnNpdGlvbiA9IGVuYWJsZVRyYW5zaXRpb247CiAgICAgIGlmIChhY3Rpb24gPT09ICdyb3RhdGVSaWdodCcgfHwgYWN0aW9uID09PSAncm90YXRlTGVmdCcpIHsKICAgICAgICB0aGlzLiRlbWl0KCdoYW5kbGVBY3Rpb25zJywgYWN0aW9uKTsKICAgICAgfQogICAgfSwKICAgIGhhbmRsZU1vdXNlRG93bihlKSB7CiAgICAgIC8vIOWPquacieW3pumUruaJjeaJp+ihjOS4i+mdoueahOWGheWuuQogICAgICBpZiAoZS5idXR0b24gIT09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMudG9vbHRpcElkKSkgewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMudG9vbHRpcElkKS5zdHlsZS5jdXJzb3IgPSAnZ3JhYmJpbmcnOwogICAgICB9CiAgICAgIGxldCBzdGFydFggPSBlLnBhZ2VYOwogICAgICBsZXQgc3RhcnRZID0gZS5wYWdlWTsKICAgICAgLy8gY29uc29sZS5sb2coZSwgc3RhcnRYLCBzdGFydFksICdoYW5kbGVNb3VzZURvd24nKTsKICAgICAgbGV0IHsgb2Zmc2V0WCwgb2Zmc2V0WSB9ID0gdGhpcy50cmFuc2Zvcm07CiAgICAgIC8vIGxldCBvID0gZS50YXJnZXQ7ICAvLyDojrflj5blvZPliY3mi5bmlL7nmoTlhYPntKAKICAgICAgLy8gbGV0IG94ID0gcGFyc2VJbnQoby5vZmZzZXRMZWZ0KTsgIC8vIOaLluaUvuWFg+e0oOeahHjovbTlnZDmoIcKICAgICAgLy8gbGV0IG95ID0gcGFyc2VJbnQoby5vZmZzZXRUb3ApOyAgLy8g5ouW5pS+5YWD57Sg55qEeei9tOWdkOaghwogICAgICAvLyB0aGlzLmRyYWdGdW4gPSByYWZUaHJvdHRsZShldiA9PiB7CiAgICAgIC8vICAgY29uc29sZS5sb2coZXYsJ2V2LS0tLS0tLS0tLS0tLS0nKTsKICAgICAgLy8gICBjb25zb2xlLmxvZyhvZmZzZXRYLCBldi5wYWdlWCwgc3RhcnRYLCAnZHJhZ0Z1biB4eHgnKTsKICAgICAgLy8gICBjb25zb2xlLmxvZyhvZmZzZXRZLCBldi5wYWdlWSwgc3RhcnRZLCAnZHJhZ0Z1biB5eXknKTsKICAgICAgLy8gICB0aGlzLnRyYW5zZm9ybS5vZmZzZXRYID0gb2Zmc2V0WCArIGV2LnBhZ2VYIC0gc3RhcnRYOwogICAgICAvLyAgIHRoaXMudHJhbnNmb3JtLm9mZnNldFkgPSBvZmZzZXRZICsgZXYucGFnZVkgLSBzdGFydFk7CiAgICAgIC8vICAgY29uc29sZS5sb2codGhpcy50cmFuc2Zvcm0ub2Zmc2V0WCwgdGhpcy50cmFuc2Zvcm0ub2Zmc2V0WSwgJ3RoaXMudHJhbnNmb3JtLm9mZnNldFgnKTsKICAgICAgLy8gfSk7CiAgICAgIHRoaXMuZHJhZ0Z1biA9IChldikgPT4gewogICAgICAgIC8vIGNvbnNvbGUubG9nKG9mZnNldFgsIGV2LnBhZ2VYLCBzdGFydFgsICdkcmFnRnVuIHh4eCcpOwogICAgICAgIC8vIGNvbnNvbGUubG9nKG9mZnNldFksIGV2LnBhZ2VZLCBzdGFydFksICdkcmFnRnVuIHl5eScpOwogICAgICAgIHRoaXMudHJhbnNmb3JtLm9mZnNldFggPSBvZmZzZXRYICsgZXYucGFnZVggLSBzdGFydFg7CiAgICAgICAgdGhpcy50cmFuc2Zvcm0ub2Zmc2V0WSA9IG9mZnNldFkgKyBldi5wYWdlWSAtIHN0YXJ0WTsKICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnRyYW5zZm9ybS5vZmZzZXRYLCB0aGlzLnRyYW5zZm9ybS5vZmZzZXRZLCAndGhpcy50cmFuc2Zvcm0ub2Zmc2V0WCcpOwogICAgICB9OwogICAgICB0aGlzLm9uKGRvY3VtZW50LCAnbW91c2Vtb3ZlJywgdGhpcy5kcmFnRnVuKTsKICAgICAgdGhpcy5vbihkb2N1bWVudCwgJ21vdXNldXAnLCBldiA9PiB7CiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMudG9vbHRpcElkKSkgewogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy50b29sdGlwSWQpLnN0eWxlLmN1cnNvciA9ICdncmFiJzsKICAgICAgICB9CiAgICAgICAgdGhpcy5vZmYoZG9jdW1lbnQsICdtb3VzZW1vdmUnLCB0aGlzLmRyYWdGdW4pOwogICAgICB9KTsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgfSwKICAgIHJlc2V0KCkgewogICAgICB0aGlzLnRyYW5zZm9ybSA9IHsKICAgICAgICBzY2FsZTogMSwKICAgICAgICBkZWc6IDAsCiAgICAgICAgZW5hYmxlVHJhbnNpdGlvbjogZmFsc2UsCiAgICAgICAgb2Zmc2V0WDogMCwKICAgICAgICBvZmZzZXRZOiAwCiAgICAgIH07CiAgICB9LAogICAgcHJldigpIHsKICAgICAgdGhpcy5pbmRleCA9ICh0aGlzLmluZGV4IC0gMSArIHRoaXMucHJldmlld1NyY0xpc3Q/Lmxlbmd0aCkgJSB0aGlzLnByZXZpZXdTcmNMaXN0Py5sZW5ndGg7CiAgICAgIHRoaXMucmVzZXQoKTsKICAgIH0sCiAgICBuZXh0KCkgewogICAgICB0aGlzLmluZGV4ID0gKHRoaXMuaW5kZXggKyAxKSAlIHRoaXMucHJldmlld1NyY0xpc3Q/Lmxlbmd0aDsKICAgICAgdGhpcy5yZXNldCgpOwogICAgfSwKICAgIGNsb3NlKCkgewogICAgICB0aGlzLnJlc2V0KCk7CiAgICAgIHRoaXMub2ZmKGRvY3VtZW50LCBtb3VzZXdoZWVsRXZlbnROYW1lLCB0aGlzLnNjcm9sbEZ1bik7CiAgICAgIHRoaXMub2ZmKGRvY3VtZW50LCAna2V5ZG93bicsIHRoaXMua2V5RG93bkhhbmRsZXIpOwogICAgICAvLyB0aGlzLnNjcm9sbEZ1biA9IG51bGw7CiAgICAgIHdpbmRvdy5vbm1vdXNld2hlZWwgPSBkb2N1bWVudC5vbm1vdXNld2hlZWwgPSBudWxsOwogICAgICB0aGlzLiRlbWl0KCdvbkNsb3NlJyk7CiAgICB9LAogICAgb2ZmKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGVsZW1lbnQsIGV2ZW50LCAnb2ZmJyk7CiAgICAgIGlmIChkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKSB7CiAgICAgICAgaWYgKGVsZW1lbnQgJiYgZXZlbnQpIHsKICAgICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgZmFsc2UpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5kZXRhY2hFdmVudCkgewogICAgICAgIGlmIChlbGVtZW50ICYmIGV2ZW50KSB7CiAgICAgICAgICBlbGVtZW50LmRldGFjaEV2ZW50KCdvbicgKyBldmVudCwgaGFuZGxlcik7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgb24oZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIpIHsKICAgICAgLy8gY29uc29sZS5sb2coZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIsICdvbicpOwogICAgICAvLyBjb25zb2xlLmxvZyhkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyLCAnb24nKTsKICAgICAgaWYgKGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIpIHsvLyBmaXJlZm94CiAgICAgICAgLy8gY29uc29sZS5sb2coJzExMScpOwogICAgICAgIGlmIChlbGVtZW50ICYmIGV2ZW50ICYmIGhhbmRsZXIpIHsKICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgZmFsc2UpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5hdHRhY2hFdmVudCkgewogICAgICAgIC8vIGNvbnNvbGUubG9nKCcyMjInKTsKICAgICAgICBpZiAoZWxlbWVudCAmJiBldmVudCAmJiBoYW5kbGVyKSB7CiAgICAgICAgICBlbGVtZW50LmF0dGFjaEV2ZW50KCdvbicgKyBldmVudCwgaGFuZGxlcik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKICBkZXN0cm95ZWQoKSB7CiAgICAvLyBpZiBhcHBlbmRUb0JvZHkgaXMgdHJ1ZSwgcmVtb3ZlIERPTSBub2RlIGFmdGVyIGRlc3Ryb3kKICAgIGlmICh0aGlzLmFwcGVuZFRvQm9keSAmJiB0aGlzLiRlbCAmJiB0aGlzLiRlbC5wYXJlbnROb2RlKSB7CiAgICAgIHRoaXMuJGVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy4kZWwpOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["imagePreview.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"imagePreview.vue","sourceRoot":"packages/image/src","sourcesContent":["<template>\n  <transition name=\"viewer-fade\">\n    <div ref=\"dj-image-preview-wrap\" class=\"dj-image-preview-wrap\" v-if=\"showViewer\">\n      <div class=\"dj-image-preview-mask\" @click.self=\"handleMaskClick\"></div>\n      <div class=\"dj-image-preview-operations\">\n        <div class=\"dj-image-preview-operations-operation\" @click=\"close\">\n          <i class=\"iconfont close\"></i>\n        </div>\n        <div class=\"dj-image-preview-operations-operation\" @click=\"handleActions('zoomIn')\">\n          <i class=\"iconfont zoom-in\"></i>\n        </div>\n        <div class=\"dj-image-preview-operations-operation\" @click=\"handleActions('zoomOut')\">\n          <i class=\"iconfont zoom-out\"></i>\n        </div>\n        <div class=\"dj-image-preview-operations-operation\" @click=\"handleActions('rotateRight')\">\n          <i class=\"iconfont rotate-right\"></i>\n        </div>\n        <div class=\"dj-image-preview-operations-operation\" @click=\"handleActions('rotateLeft')\">\n          <i class=\"iconfont rotate-left\"></i>\n        </div>\n        <div v-if=\"downloadStatus\" class=\"dj-image-preview-operations-operation\" @click=\"download\">\n          <i class=\"iconfont download\"></i>\n        </div>\n      </div>\n      <div v-if=\"previewSrcList && previewSrcList.length > 1\" class=\"dj-image-preview-switch-left\" @click=\"prev\">\n        <i class=\"iconfont arrow-left f30\"></i>\n      </div>\n      <div v-if=\"previewSrcList && previewSrcList.length > 1\" class=\"dj-image-preview-switch-right\" @click=\"next\">\n        <i class=\"iconfont arrow-right f30\"></i>\n      </div>\n      <div class=\"dj-img-preview-wrapper\" :style=\"wrapperStyle\">\n        <img :src=\"currentImg\" alt=\"\" :style=\"imgStyle\" :id=\"tooltipId\" @mousedown=\"handleMouseDown\">\n      </div>\n    </div>\n  </transition>\n</template>\n\n<script>\nlet prevOverflow = '';\nlet mousewheelEventName = 'mousewheel';\nif (document.addEventListener) {// firefox\n  mousewheelEventName = 'DOMMouseScroll';\n} else {\n  // window.onmousewheel = document.onmousewheel = this.scrollFun;\n  mousewheelEventName = 'onmousewheel';\n}\n// function rafThrottle(fn) {\n//   let locked = false;\n//   return function(...args) {\n//     if (locked) return;\n//     locked = true;\n//     window.requestAnimationFrame(_ => {\n//       fn.apply(this, args);\n//       locked = false;\n//     });\n//   };\n// }\nexport default {\n  name: 'djImagePreview',\n  props: {\n    previewSrcList: {\n      type: Array,\n      default: () => []\n    },\n    initialIndex: {\n      type: Number,\n      default: 0\n    },\n    maskClosable: {\n      type: Boolean,\n      default: true\n    },\n    showViewer: {\n      type: Boolean,\n      default: true\n    },\n    // 是否显示下载\n    downloadStatus: {\n      type: Boolean,\n      default: true\n    }\n  },\n  data() {\n    return {\n      appendToBody: true,\n      index: this.initialIndex,\n      transform: {\n        scale: 1,\n        deg: 0,\n        enableTransition: false,\n        offsetX: 0,\n        offsetY: 0\n      }\n    };\n  },\n  computed: {\n    currentImg() {\n      return this.previewSrcList[this.index];\n    },\n    imgStyle() {\n      let style = {};\n      style.maxWidth = style.maxHeight = '100%';\n      style.transform = `scale(${this.transform.scale}) rotate(${this.transform.deg}deg)`;\n      style.transition = this.transform.enableTransition ? 'transform .3s' : '';\n      style.marginTop = this.transform.offsetY + 'px';\n      style.marginLeft = this.transform.offsetX + 'px';\n      return style;\n    },\n    wrapperStyle() {\n      let style = {};\n      // style.transform = `translate3d(${this.transform.offsetX / 2}px, ${this.transform.offsetY / 2}px, 0)`;\n      return style;\n    },\n    tooltipId() {\n      return `dj-img-preview-${Math.floor(Math.random() * 10000)}`;\n    }\n  },\n  watch: {\n    showViewer: {\n      handler() {\n        // console.log(this.showViewer, 'this.showViewer');\n        if (this.showViewer) {\n          this.on(document, mousewheelEventName, this.scrollFun);\n          this.on(document, 'keydown', this.keyDownHandler);\n          // Safari与Chrome属于同一类型\n          window.onmousewheel = document.onmousewheel = this.scrollFun;\n          prevOverflow = document.body.style.overflow;\n          document.body.style.overflow = 'hidden';\n        } else {\n          document.body.style.overflow = prevOverflow;\n        }\n      },\n      deep: true\n    },\n    initialIndex: {\n      handler() {\n        this.index = this.initialIndex;\n      },\n      deep: true\n    }\n  },\n  mounted() {\n    // this.deviceSupportInstall();\n    if (this.appendToBody) {\n      document.body.appendChild(this.$el);\n    }\n  },\n  methods: {\n    download() {\n      // console.log(this.$listeners, '$listeners');\n      if (this.$listeners?.download) {// this.customDownload\n        this.$emit('download');\n        return;\n      }\n      // console.log('子级内置下载');\n      // return;\n      // eslint-disable-next-line no-unreachable\n      this.downloadFun();\n    },\n    downloadFun() {\n      let image = document.getElementById(this.tooltipId); // 获取要下载的图片\n      let imgUrl = image.src; // 获取图片地址\n      let imgUrlArr = imgUrl?.split('/');\n      let imgUrlName = imgUrlArr[imgUrlArr?.length - 1];\n      var xhr = new XMLHttpRequest();\n      xhr.open('get', imgUrl, true);\n      // 至关重要\n      xhr.responseType = 'blob';\n      xhr.onload = function() {\n        if (this.status == 200) {\n          // 得到一个blob对象\n          let blob = this.response;\n          // 至关重要\n          let oFileReader = new FileReader();\n          oFileReader.onloadend = function(e) {\n            let base64 = e.target.result;\n            let eleLink = document.createElement('a');\n            eleLink.download = imgUrlName;\n            eleLink.style.display = 'none';\n            eleLink.href = base64;\n            // 触发点击\n            document.body.appendChild(eleLink);\n            eleLink.click();\n            // 然后移除\n            document.body.removeChild(eleLink);\n          };\n          oFileReader.readAsDataURL(blob);\n        }\n      };\n      xhr.send();\n      /* let imgUrlSuffixArr = imgUrl?.split('.');\n      let imgUrlSuffix = imgUrlSuffixArr[imgUrlSuffixArr?.length - 1];\n      console.log(imgUrlName,'imgUrlName');\n      image.setAttribute('crossOrigin', 'anonymous');\n      this.funDownload(image, imgUrlName, imgUrlSuffix);*/\n    },\n    funDownload(domImg, filename, suffix) {\n      let c = document.getElementById('myCanvas');\n      let ctx = c.getContext('2d');\n      setTimeout(() => {\n        ctx.drawImage(domImg, 0, 0);\n      }, 10);\n      // console.log(domImg, 'domImg');\n      // 创建隐藏的可下载链接\n      var eleLink = document.createElement('a');\n      eleLink.download = filename;\n      eleLink.style.display = 'none';\n      // 图片转base64地址\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      setTimeout(() => {\n        var width = domImg.naturalWidth;\n        var height = domImg.naturalHeight;\n        canvas.width = width;\n        canvas.height = height;\n        // console.log(canvas, 'canvas');\n        // console.log(context, 'context');\n        context.drawImage(domImg, 0, 0);\n        // 如果是PNG图片，则canvas.toDataURL('image/png')\n        // eleLink.href = canvas.toDataURL('image/' + suffix);\n        eleLink.href = canvas.toDataURL('image/gif');\n        // 触发点击\n        document.body.appendChild(eleLink);\n        eleLink.click();\n        // 然后移除\n        document.body.removeChild(eleLink);\n      }, 10);\n    },\n    // 按键事件\n    keyDownHandler(e) {\n      e.stopPropagation();\n      const keyCode = e.keyCode;\n      switch (keyCode) {\n        // ESC\n        case 27:\n          this.close();\n          break;\n        // 左箭头\n        case 37:\n          this.prev();\n          break;\n        // 右箭头\n        case 39:\n          this.next();\n          break;\n      }\n    },\n    // 背景点击\n    handleMaskClick() {\n      // console.log('handleMaskClick');\n      if (this.maskClosable) {\n        this.close();\n      }\n    },\n    // 鼠标滚轮滚动\n    scrollFun(e) {\n      e = e || window.event;\n      // console.log(e, 'eeeeee');\n      if (e.wheelDelta) {// 判断浏览器IE，谷歌滑轮事件\n        if (e.wheelDelta > 0) {// 当滑轮向上滚动时\n          // console.log('上滚 IE，谷歌');\n          this.handleActions('zoomIn', { zoomRate: 0.015, enableTransition: false });\n        }\n        if (e.wheelDelta < 0) {// 当滑轮向下滚动时\n          // console.log('下滚 IE，谷歌');\n          this.handleActions('zoomOut', { zoomRate: 0.015, enableTransition: false });\n        }\n      } else if (e.detail) {// Firefox滑轮事件\n        if (e.detail > 0) {// 当滑轮向下滚动时\n          this.handleActions('zoomOut', { zoomRate: 0.015, enableTransition: false });\n          // console.log('下滚 Firefox');\n        }\n        if (e.detail < 0) {// 当滑轮向上滚动时\n          this.handleActions('zoomIn', { zoomRate: 0.015, enableTransition: false });\n          // console.log('上滚 Firefox');\n        }\n      }\n    },\n    // 动作\n    handleActions(action, options) {\n      let transform = this.transform;\n      let { enableTransition, zoomRate, rotateDeg } = {\n        zoomRate: 0.2,\n        rotateDeg: 90,\n        enableTransition: true,\n        ...options\n      };\n      switch (action) {\n        case 'zoomOut':\n          if (transform.scale > 0.2) {\n            transform.scale = parseFloat((transform.scale - zoomRate).toFixed(3));\n          }\n          break;\n        case 'zoomIn':\n          transform.scale = parseFloat((transform.scale + zoomRate).toFixed(3));\n          break;\n        case 'rotateRight':\n          transform.deg += rotateDeg;\n          break;\n        case 'rotateLeft':\n          transform.deg -= rotateDeg;\n          break;\n      }\n      this.transform.enableTransition = enableTransition;\n      if (action === 'rotateRight' || action === 'rotateLeft') {\n        this.$emit('handleActions', action);\n      }\n    },\n    handleMouseDown(e) {\n      // 只有左键才执行下面的内容\n      if (e.button !== 0) {\n        return;\n      }\n      if (document.getElementById(this.tooltipId)) {\n        document.getElementById(this.tooltipId).style.cursor = 'grabbing';\n      }\n      let startX = e.pageX;\n      let startY = e.pageY;\n      // console.log(e, startX, startY, 'handleMouseDown');\n      let { offsetX, offsetY } = this.transform;\n      // let o = e.target;  // 获取当前拖放的元素\n      // let ox = parseInt(o.offsetLeft);  // 拖放元素的x轴坐标\n      // let oy = parseInt(o.offsetTop);  // 拖放元素的y轴坐标\n      // this.dragFun = rafThrottle(ev => {\n      //   console.log(ev,'ev--------------');\n      //   console.log(offsetX, ev.pageX, startX, 'dragFun xxx');\n      //   console.log(offsetY, ev.pageY, startY, 'dragFun yyy');\n      //   this.transform.offsetX = offsetX + ev.pageX - startX;\n      //   this.transform.offsetY = offsetY + ev.pageY - startY;\n      //   console.log(this.transform.offsetX, this.transform.offsetY, 'this.transform.offsetX');\n      // });\n      this.dragFun = (ev) => {\n        // console.log(offsetX, ev.pageX, startX, 'dragFun xxx');\n        // console.log(offsetY, ev.pageY, startY, 'dragFun yyy');\n        this.transform.offsetX = offsetX + ev.pageX - startX;\n        this.transform.offsetY = offsetY + ev.pageY - startY;\n        // console.log(this.transform.offsetX, this.transform.offsetY, 'this.transform.offsetX');\n      };\n      this.on(document, 'mousemove', this.dragFun);\n      this.on(document, 'mouseup', ev => {\n        if (document.getElementById(this.tooltipId)) {\n          document.getElementById(this.tooltipId).style.cursor = 'grab';\n        }\n        this.off(document, 'mousemove', this.dragFun);\n      });\n      e.preventDefault();\n    },\n    reset() {\n      this.transform = {\n        scale: 1,\n        deg: 0,\n        enableTransition: false,\n        offsetX: 0,\n        offsetY: 0\n      };\n    },\n    prev() {\n      this.index = (this.index - 1 + this.previewSrcList?.length) % this.previewSrcList?.length;\n      this.reset();\n    },\n    next() {\n      this.index = (this.index + 1) % this.previewSrcList?.length;\n      this.reset();\n    },\n    close() {\n      this.reset();\n      this.off(document, mousewheelEventName, this.scrollFun);\n      this.off(document, 'keydown', this.keyDownHandler);\n      // this.scrollFun = null;\n      window.onmousewheel = document.onmousewheel = null;\n      this.$emit('onClose');\n    },\n    off(element, event, handler) {\n      // console.log(element, event, 'off');\n      if (document.removeEventListener) {\n        if (element && event) {\n          element.removeEventListener(event, handler, false);\n        }\n      } else if (document.detachEvent) {\n        if (element && event) {\n          element.detachEvent('on' + event, handler);\n        }\n      }\n    },\n    on(element, event, handler) {\n      // console.log(element, event, handler, 'on');\n      // console.log(document.addEventListener, 'on');\n      if (document.addEventListener) {// firefox\n        // console.log('111');\n        if (element && event && handler) {\n          element.addEventListener(event, handler, false);\n        }\n      } else if (document.attachEvent) {\n        // console.log('222');\n        if (element && event && handler) {\n          element.attachEvent('on' + event, handler);\n        }\n      }\n    }\n  },\n  destroyed() {\n    // if appendToBody is true, remove DOM node after destroy\n    if (this.appendToBody && this.$el && this.$el.parentNode) {\n      this.$el.parentNode.removeChild(this.$el);\n    }\n  }\n};\n</script>\n\n<style scoped lang=\"less\">\n</style>\n"]}]}