{"remainingRequest":"/Users/wangjunxia/work-github/dj-design/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangjunxia/work-github/dj-design/packages/messageBox/src/messageBox.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangjunxia/work-github/dj-design/packages/messageBox/src/messageBox.vue","mtime":1676537858398},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjunxia/work-github/dj-design/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAqIGFzIGRvbSBmcm9tICdAL3V0aWxzL2RvbSc7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgIHRpdGxlOiBudWxsLAogICAgICBtZXNzYWdlOiAnJywKICAgICAgYmVmb3JlQ2xvc2U6IG51bGwsCiAgICAgIGNhbmNlbHRleHQ6ICflj5bmtognLAogICAgICBva3RleHQ6ICfnoa7lrponLAogICAgICBjYW5jZWxCdXR0b25TaG93OiB0cnVlLAogICAgICB2bm9kZTogZmFsc2UsCiAgICAgIGJhY2tncm91bmQ6ICdibGFjaycsCiAgICAgIGNsb3NhYmxlOiBmYWxzZSwKICAgICAgc2hvd2Nsb3NlOiB0cnVlLAogICAgICBzaXplOiAnbWluaScsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgIHR5cGU6IG51bGwsCiAgICAgIGNsYXNzTmFtZTogJycKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgdHlwZUJhY2tncm91bmQoKSB7CiAgICAgIGxldCBuYW1lID0gJ2RqLW1vZGFsLWJhY2tncm91bmQtJzsKICAgICAgcmV0dXJuIHRoaXMuYmFja2dyb3VuZCA9PT0gJ3doaXRlJyA/IGAke25hbWV9d2hpdGVgIDogYCR7bmFtZX1ibGFja2A7CiAgICB9LAogICAgdHlwZUljb24oKSB7CiAgICAgIGNvbnN0IHsgdHlwZSB9ID0gdGhpczsKICAgICAgcmV0dXJuIHR5cGUgPT09ICdzdWNjZXNzJyAmJiAnY2hlY2stZmlsbGVkJyB8fAogICAgICB0eXBlID09PSAnZXJyb3InICYmICdjbG9zZS1maWxsZWQnIHx8CiAgICAgIHR5cGUgPT09ICd3YXJuaW5nJyAmJiAnY2F1dGlvbi1maWxsZWQnIHx8CiAgICAgIHR5cGUgPT09ICdoZWxwJyAmJiAnaGVscC1maWxsZWQnOwogICAgfQogIH0sCiAgY3JlYXRlZCgpewogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BvcHN0YXRlJywgdGhpcy5wb3BzdGF0ZSwgZmFsc2UpOwogIH0sCiAgbW91bnRlZCgpewogIH0sCiAgbWV0aG9kczogewogICAgZG9DbG9zZSgpIHsKICAgICAgdGhpcy5jcmVhdGVNc2coKTsKICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMucG9wc3RhdGUoKTsKICAgIH0sCiAgICBoYW5kbGVBY3Rpb24oYWN0aW9uKSB7CiAgICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7CiAgICAgIGxldCBtb2RhbCA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5kai1tb2RhbCcpOwoKICAgICAgdGhpcy5hY3Rpb24gPSBhY3Rpb247CiAgICAgIGlmICh0eXBlb2YgdGhpcy5iZWZvcmVDbG9zZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHRoaXMuYmVmb3JlQ2xvc2UoYWN0aW9uLCB0aGlzLCAoKT0+ewogICAgICAgICAgaWYgKGFjdGlvbil7CiAgICAgICAgICAgIHRoaXMub2sgJiYgdGhpcy5vaygpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5jbG9zZSAmJiB0aGlzLmNsb3NlKCk7CiAgICAgICAgICB9CiAgICAgICAgICBkb20uYWRkQ2xhc3MobW9kYWwsICdkai1tb2RhbC1oaWRlJyk7CiAgICAgICAgICBpZiAoYm9keS5xdWVyeVNlbGVjdG9yQWxsKCcuZGotbW9kYWwtYmFja2dyb3VuZC5kai1tb2RhbC12aXNpYmxlJykubGVuZ3RoIDw9IDEpIHsKICAgICAgICAgICAgZG9tLmFkZENsYXNzKHRoaXMuJGVsLCAnZGotbW9kYWwtaGlkZScpOwogICAgICAgICAgfQogICAgICAgICAgLy8gdGhpcy5iZWZvcmUgPSBudWxsOwogICAgICAgICAgLy8gdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnRpbWVyRm4oKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoYWN0aW9uKXsKICAgICAgICAgIHRoaXMub2sgJiYgdGhpcy5vaygpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmNsb3NlICYmIHRoaXMuY2xvc2UoKTsKICAgICAgICB9CiAgICAgICAgZG9tLmFkZENsYXNzKG1vZGFsLCAnZGotbW9kYWwtaGlkZScpOwogICAgICAgIGlmIChib2R5LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kai1tb2RhbC1iYWNrZ3JvdW5kLmRqLW1vZGFsLXZpc2libGUnKS5sZW5ndGggPD0gMSkgewogICAgICAgICAgZG9tLmFkZENsYXNzKHRoaXMuJGVsLCAnZGotbW9kYWwtaGlkZScpOwogICAgICAgIH0KICAgICAgICB0aGlzLmNhbGxiYWNrKGFjdGlvbiwgdGhpcyk7CiAgICAgICAgdGhpcy50aW1lckZuKCk7CiAgICAgIH0KICAgIH0sCiAgICB0aW1lckZuKCl7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHRoaXMuY3JlYXRlTXNnKCk7CiAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7CiAgICAgICAgbGV0IHRpbWVyID0gbnVsbDsKICAgICAgICB0aW1lciA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgdGhpcy4kZWwucGFyZW50Tm9kZSAhPT0gbnVsbCAmJiBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRoaXMuJGVsKTsKICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7CiAgICAgICAgICB0aW1lciA9IG51bGw7CiAgICAgICAgfSwgMSk7CiAgICAgIH0sIDMwMCk7CiAgICB9LAogICAgcG9wc3RhdGUoKSB7CiAgICAgIGxldCBlbHM9ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZGotbW9kYWwtYmFja2dyb3VuZCcpOwogICAgICBpZiAoZWxzKXsKICAgICAgICBmb3IgKGxldCBpPTA7aTxlbHMubGVuZ3RoO2krKyl7CiAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsc1tpXSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["messageBox.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"messageBox.vue","sourceRoot":"packages/messageBox/src","sourcesContent":["<template>\n  <div class=\"dj-modal-background dj-message-box\" :class=\"(visible && 'dj-modal-visible ' || '') + typeBackground + ' ' + className\" v-show=\"visible\" @click=\"(closable && handleAction(false))\">\n    <transition>\n      <div class=\"dj-modal\" :class=\"'dj-modal-' + size\" @click.stop>\n        <div class=\"dj-modal-header\">\n          <slot>\n            <span v-if=\"!vnode\">{{ title }}</span>\n            <span v-else v-html=\"title\"></span>\n          </slot>\n          <i class=\"iconfont close dj-modal-close\"  @click.stop=\"handleAction(null)\"  v-if=\"showclose\"></i>\n        </div>\n        <div class=\"dj-modal-content\">\n          <dj-icon :icon=\"typeIcon\" class=\"dj-message-type\" v-if=\"type\"></dj-icon>\n          <slot>\n            <div class=\"dj-message-inin\">\n              <span v-if=\"!vnode\">{{ message }}</span>\n              <span v-else v-html=\"message\"></span>\n            </div>\n          </slot>\n        </div>\n        <div class=\"dj-modal-footer\">\n          <dj-button @click.stop=\"handleAction(false)\" v-if=\"cancelButtonShow\">{{canceltext}}</dj-button>\n          <span class=\"spacing\"></span>\n          <dj-button type=\"primary\" :loading=\"loading\" :disabled=\"disabled\" @click.stop=\"handleAction(true)\">{{oktext}}</dj-button>\n        </div>\n      </div>\n    </transition>\n  </div>\n</template>\n\n<script>\nimport * as dom from '@/utils/dom';\nexport default {\n  data() {\n    return {\n      visible: false,\n      title: null,\n      message: '',\n      beforeClose: null,\n      canceltext: '取消',\n      oktext: '确定',\n      cancelButtonShow: true,\n      vnode: false,\n      background: 'black',\n      closable: false,\n      showclose: true,\n      size: 'mini',\n      loading: false,\n      disabled: false,\n      type: null,\n      className: ''\n    };\n  },\n  computed: {\n    typeBackground() {\n      let name = 'dj-modal-background-';\n      return this.background === 'white' ? `${name}white` : `${name}black`;\n    },\n    typeIcon() {\n      const { type } = this;\n      return type === 'success' && 'check-filled' ||\n      type === 'error' && 'close-filled' ||\n      type === 'warning' && 'caution-filled' ||\n      type === 'help' && 'help-filled';\n    }\n  },\n  created(){\n    window.addEventListener('popstate', this.popstate, false);\n  },\n  mounted(){\n  },\n  methods: {\n    doClose() {\n      this.createMsg();\n      this.visible = false;\n      this.popstate();\n    },\n    handleAction(action) {\n      const body = document.querySelector('body');\n      let modal = this.$el.querySelector('.dj-modal');\n\n      this.action = action;\n      if (typeof this.beforeClose === 'function') {\n        this.beforeClose(action, this, ()=>{\n          if (action){\n            this.ok && this.ok();\n          } else {\n            this.close && this.close();\n          }\n          dom.addClass(modal, 'dj-modal-hide');\n          if (body.querySelectorAll('.dj-modal-background.dj-modal-visible').length <= 1) {\n            dom.addClass(this.$el, 'dj-modal-hide');\n          }\n          // this.before = null;\n          // this.loading = false;\n          this.timerFn();\n        });\n      } else {\n        if (action){\n          this.ok && this.ok();\n        } else {\n          this.close && this.close();\n        }\n        dom.addClass(modal, 'dj-modal-hide');\n        if (body.querySelectorAll('.dj-modal-background.dj-modal-visible').length <= 1) {\n          dom.addClass(this.$el, 'dj-modal-hide');\n        }\n        this.callback(action, this);\n        this.timerFn();\n      }\n    },\n    timerFn(){\n      setTimeout(() => {\n        this.createMsg();\n        this.visible = false;\n        let timer = null;\n        timer = setTimeout(() => {\n          this.$el.parentNode !== null && document.body.removeChild(this.$el);\n          clearTimeout(timer);\n          timer = null;\n        }, 1);\n      }, 300);\n    },\n    popstate() {\n      let els=document.getElementsByClassName('dj-modal-background');\n      if (els){\n        for (let i=0;i<els.length;i++){\n          document.body.removeChild(els[i]);\n        }\n      }\n    }\n  }\n};\n</script>\n\n<style scoped lang=\"less\"></style>\n"]}]}